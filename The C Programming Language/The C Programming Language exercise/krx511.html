<html>
  <head>

    <title>
      The C Programming Language Exercise 5-11
    </title>

  <BODY    text="#000000"
        bgcolor="#DDDDDD"
           link="#800000"
          alink="#008000"
          vlink="#000080">


<center>
<h2>
  &quot;The C Programming Language&quot;, 2nd edition, Kernighan and Ritchie
</h2>
<h3>
  Answer to Exercise 5-11, page 118
</h3>
<h4>
  Solution by <a href=mailto:gkp1@flash.net>  Gregory Pietsch </a>
</h4>
</center>

<i>
Modify the programs <code>entab</code> and <code>detab</code> (written as exercises in Chapter 1) to
accept a list of tab stops as arguments. Use the default tab settings if there
are no arguments.
</i>
<br>
<br>
<br>
Here's detab...
<br>
<code>
<pre>
<FONT COLOR="#008080">/****************************************************************************

detab.c - Source code for the detab command

AUTHOR: Gregory Pietsch

DESCRIPTION:

detab - expand tabs into spaces

****************************************************************************/</FONT>

<FONT COLOR="#008080">/* include files */</FONT>
<FONT COLOR="#0000FF"><B>#include &lt;stdio.h&gt;</B></FONT>
<FONT COLOR="#0000FF"><B>#include &lt;string.h&gt;</B></FONT>

<FONT COLOR="#008080">/* macros */</FONT>
<FONT COLOR="#0000FF"><B>#define NO_ARG          0</B></FONT>
<FONT COLOR="#0000FF"><B>#define REQUIRED_ARG    1</B></FONT>
<FONT COLOR="#0000FF"><B>#define OPTIONAL_ARG    2</B></FONT>

<FONT COLOR="#008080">/* types */</FONT>

<FONT COLOR="#008080">/* GETOPT_LONG_OPTION_T: The type of long option */</FONT>
<B><FONT COLOR="#000080">typedef</FONT></B> <B><FONT COLOR="#000080">struct</FONT></B> <FONT COLOR="#008000">GETOPT_LONG_OPTION_T</FONT> <FONT COLOR="#000080">{</FONT>
    <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">name</FONT><FONT COLOR="#000080">;</FONT>         <FONT COLOR="#008080">/* the name of the long option */</FONT>
    <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">has_arg</FONT><FONT COLOR="#000080">;</FONT>        <FONT COLOR="#008080">/* one of the above macros */</FONT>
    <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">flag</FONT><FONT COLOR="#000080">;</FONT>          <FONT COLOR="#008080">/* determines if getopt_long() returns a
                         * value for a long option; if it is
                         * non-NULL, 0 is returned as a function
                         * value and the value of val is stored in
                         * the area pointed to by flag.  Otherwise,
                         * val is returned. */</FONT>
    <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">val</FONT><FONT COLOR="#000080">;</FONT>            <FONT COLOR="#008080">/* determines the value to return if flag is
                         * NULL. */</FONT>
<FONT COLOR="#000080">}</FONT> <FONT COLOR="#008000">GETOPT_LONG_OPTION_T</FONT><FONT COLOR="#000080">;</FONT>

<B><FONT COLOR="#000080">typedef</FONT></B> <B><FONT COLOR="#000080">enum</FONT></B> <FONT COLOR="#008000">GETOPT_ORDERING_T</FONT> <FONT COLOR="#000080">{</FONT>
    <FONT COLOR="#008000">PERMUTE</FONT><FONT COLOR="#000080">,</FONT>
    <FONT COLOR="#008000">RETURN_IN_ORDER</FONT><FONT COLOR="#000080">,</FONT>
    <FONT COLOR="#008000">REQUIRE_ORDER</FONT>
<FONT COLOR="#000080">}</FONT> <FONT COLOR="#008000">GETOPT_ORDERING_T</FONT><FONT COLOR="#000080">;</FONT>

<FONT COLOR="#008080">/* globally-defined variables */</FONT>
<B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">optarg</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">;</FONT>
<B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">optind</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
<B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">opterr</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
<B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">optopt</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>'?'</B></FONT><FONT COLOR="#000080">;</FONT>

<FONT COLOR="#008080">/* statically-defined variables */</FONT>

<B><FONT COLOR="#000080">static</FONT></B> <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">program_name</FONT><FONT COLOR="#000080">;</FONT>
 <FONT COLOR="#008080">/* if nonzero, it means tab every x characters */</FONT>
<B><FONT COLOR="#000080">static</FONT></B> <B><FONT COLOR="#000080">unsigned</FONT></B> <B><FONT COLOR="#000080">long</FONT></B> <FONT COLOR="#008000">tab_every</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>8</B></FONT><FONT COLOR="#000080">;</FONT>
 <FONT COLOR="#008080">/* -i: only handle initial tabs/spaces */</FONT>
<B><FONT COLOR="#000080">static</FONT></B> <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">flag_initial</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
 <FONT COLOR="#008080">/* expand tabs into spaces */</FONT>
<B><FONT COLOR="#000080">static</FONT></B> <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">flag_expand</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
<B><FONT COLOR="#000080">static</FONT></B> <B><FONT COLOR="#000080">unsigned</FONT></B> <B><FONT COLOR="#000080">long</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">tab_stop_list</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">;</FONT>
<B><FONT COLOR="#000080">static</FONT></B> <FONT COLOR="#008000">size_t</FONT> <FONT COLOR="#008000">num_tab_stops</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
<B><FONT COLOR="#000080">static</FONT></B> <FONT COLOR="#008000">size_t</FONT> <FONT COLOR="#008000">num_tab_stops_allocked</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
<B><FONT COLOR="#000080">static</FONT></B> <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">show_help</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
<B><FONT COLOR="#000080">static</FONT></B> <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">show_version</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
<B><FONT COLOR="#000080">static</FONT></B> <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">shortopts</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000">&quot;it:&quot;</FONT><FONT COLOR="#000080">;</FONT>
<B><FONT COLOR="#000080">static</FONT></B> <FONT COLOR="#008000">GETOPT_LONG_OPTION_T</FONT> <FONT COLOR="#008000">longopts</FONT><FONT COLOR="#000080">[]</FONT> <FONT COLOR="#000080">=</FONT>
<FONT COLOR="#000080">{</FONT>
    <FONT COLOR="#000080">{</FONT><FONT COLOR="#000000">&quot;initial&quot;</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">NO_ARG</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000"><B>'i'</B></FONT><FONT COLOR="#000080">},</FONT>
    <FONT COLOR="#000080">{</FONT><FONT COLOR="#000000">&quot;tabs&quot;</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">REQUIRED_ARG</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000"><B>'t'</B></FONT><FONT COLOR="#000080">},</FONT>

    <FONT COLOR="#000080">{</FONT><FONT COLOR="#000000">&quot;help&quot;</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">NO_ARG</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000080">&amp;</FONT><FONT COLOR="#008000">show_help</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">},</FONT>
    <FONT COLOR="#000080">{</FONT><FONT COLOR="#000000">&quot;version&quot;</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">NO_ARG</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000080">&amp;</FONT><FONT COLOR="#008000">show_version</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">},</FONT>
    <FONT COLOR="#000080">{</FONT><FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">}</FONT>
<FONT COLOR="#000080">};</FONT>

<FONT COLOR="#008080">/* functions */</FONT>

<FONT COLOR="#008080">/* reverse_argv_elements:  reverses num elements starting at argv */</FONT>
<B><FONT COLOR="#000080">static</FONT></B> <B><FONT COLOR="#000080">void</FONT></B> <FONT COLOR="#008000">reverse_argv_elements</FONT><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">**</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">,</FONT> <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">num</FONT><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
    <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">tmp</FONT><FONT COLOR="#000080">;</FONT>

    <B><FONT COLOR="#000080">for</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">i</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT> <FONT COLOR="#008000">i</FONT> <FONT COLOR="#000080">&lt;</FONT> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">num</FONT> <FONT COLOR="#000080">&gt;&gt;</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">);</FONT> <FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">++)</FONT> <FONT COLOR="#000080">{</FONT>
        <FONT COLOR="#008000">tmp</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">];</FONT>
        <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">num</FONT> <FONT COLOR="#000080">-</FONT> <FONT COLOR="#008000">i</FONT> <FONT COLOR="#000080">-</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">];</FONT>
        <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">num</FONT> <FONT COLOR="#000080">-</FONT> <FONT COLOR="#008000">i</FONT> <FONT COLOR="#000080">-</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">tmp</FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#000080">}</FONT>
<FONT COLOR="#000080">}</FONT>

<FONT COLOR="#008080">/* permute: swap two blocks of argv-elements given their lengths */</FONT>
<B><FONT COLOR="#000080">static</FONT></B> <B><FONT COLOR="#000080">void</FONT></B> <FONT COLOR="#008000">permute</FONT><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">**</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">,</FONT> <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">len1</FONT><FONT COLOR="#000080">,</FONT> <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">len2</FONT><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
    <FONT COLOR="#008000">reverse_argv_elements</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">len1</FONT><FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#008000">reverse_argv_elements</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">len1</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#008000">len2</FONT><FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#008000">reverse_argv_elements</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">len2</FONT><FONT COLOR="#000080">);</FONT>
<FONT COLOR="#000080">}</FONT>

<FONT COLOR="#008080">/* is_option: is this argv-element an option or the end of the option
list? */</FONT>
<B><FONT COLOR="#000080">static</FONT></B> <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">is_option</FONT><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">argv_element</FONT><FONT COLOR="#000080">,</FONT> <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">only</FONT><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
    <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#000080">((</FONT><FONT COLOR="#008000">argv_element</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)</FONT>
            <FONT COLOR="#000080">||</FONT> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv_element</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>'-'</B></FONT><FONT COLOR="#000080">)</FONT>
            <FONT COLOR="#000080">||</FONT> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">only</FONT> <FONT COLOR="#000080">&amp;&amp;</FONT> <FONT COLOR="#008000">argv_element</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>'+'</B></FONT><FONT COLOR="#000080">));</FONT>
<FONT COLOR="#000080">}</FONT>

<FONT COLOR="#008080">/* getopt_internal:  the function that does all the dirty work */</FONT>
<B><FONT COLOR="#000080">static</FONT></B> <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">getopt_internal</FONT><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">argc</FONT><FONT COLOR="#000080">,</FONT> <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">**</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">,</FONT> <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">shortopts</FONT><FONT COLOR="#000080">,</FONT>
                 <FONT COLOR="#008000">GETOPT_LONG_OPTION_T</FONT> <FONT COLOR="#000080">*</FONT> <FONT COLOR="#008000">longopts</FONT><FONT COLOR="#000080">,</FONT> <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">longind</FONT><FONT COLOR="#000080">,</FONT> <B><FONT COLOR="#000080">int</FONT></B>
<FONT COLOR="#008000">only</FONT><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
    <FONT COLOR="#008000">GETOPT_ORDERING_T</FONT> <FONT COLOR="#008000">ordering</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">PERMUTE</FONT><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">static</FONT></B> <FONT COLOR="#008000">size_t</FONT> <FONT COLOR="#008000">optwhere</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#008000">size_t</FONT> <FONT COLOR="#008000">permute_from</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">num_nonopts</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">optindex</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#008000">size_t</FONT> <FONT COLOR="#008000">match_chars</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">possible_arg</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">longopt_match</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000080">-</FONT><FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">has_arg</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000080">-</FONT><FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">cp</FONT><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">arg_next</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>

    <FONT COLOR="#008080">/* first, deal with silly parameters and easy stuff */</FONT>
    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argc</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>0</B></FONT> <FONT COLOR="#000080">||</FONT> <FONT COLOR="#008000">argv</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">NULL</FONT> <FONT COLOR="#000080">||</FONT> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">shortopts</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">NULL</FONT> <FONT COLOR="#000080">&amp;&amp;</FONT> <FONT COLOR="#008000">longopts</FONT> <FONT COLOR="#000080">==</FONT>
<FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">))</FONT>
        <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">optopt</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>'?'</B></FONT><FONT COLOR="#000080">);</FONT>
    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">optind</FONT> <FONT COLOR="#000080">&gt;=</FONT> <FONT COLOR="#008000">argc</FONT> <FONT COLOR="#000080">||</FONT> <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)</FONT>
        <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#008000">EOF</FONT><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">strcmp</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">],</FONT> <FONT COLOR="#000000">&quot;--&quot;</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
        <FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">++;</FONT>
        <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#008000">EOF</FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#000080">}</FONT>
    <FONT COLOR="#008080">/* if this is our first time through */</FONT>
    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">optind</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">)</FONT>
        <FONT COLOR="#008000">optind</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">optwhere</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>

    <FONT COLOR="#008080">/* define ordering */</FONT>
    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">shortopts</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">NULL</FONT> <FONT COLOR="#000080">&amp;&amp;</FONT> <FONT COLOR="#000080">(*</FONT><FONT COLOR="#008000">shortopts</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>'-'</B></FONT> <FONT COLOR="#000080">||</FONT> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">shortopts</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>'+'</B></FONT><FONT COLOR="#000080">))</FONT> <FONT COLOR="#000080">{</FONT>
        <FONT COLOR="#008000">ordering</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000080">(*</FONT><FONT COLOR="#008000">shortopts</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>'-'</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">?</FONT> <FONT COLOR="#008000">RETURN_IN_ORDER</FONT> <FONT COLOR="#000080">:</FONT>
<FONT COLOR="#008000">REQUIRE_ORDER</FONT><FONT COLOR="#000080">;</FONT>
        <FONT COLOR="#008000">shortopts</FONT><FONT COLOR="#000080">++;</FONT>
    <FONT COLOR="#000080">}</FONT>
    <B><FONT COLOR="#000080">else</FONT></B>
        <FONT COLOR="#008000">ordering</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">getenv</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#000000">&quot;POSIXLY_CORRECT&quot;</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">?</FONT> <FONT COLOR="#008000">REQUIRE_ORDER</FONT> <FONT COLOR="#000080">:</FONT>
            <FONT COLOR="#008000">PERMUTE</FONT><FONT COLOR="#000080">;</FONT>

    <FONT COLOR="#008080">/*
     * based on ordering, find our next option, if we're at the
beginning of
     * one
     */</FONT>
    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">optwhere</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
        <B><FONT COLOR="#000080">switch</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">ordering</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
        <B><FONT COLOR="#000080">case</FONT></B> <FONT COLOR="#008000">PERMUTE</FONT><FONT COLOR="#000080">:</FONT>
            <FONT COLOR="#008000">permute_from</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">;</FONT>
            <FONT COLOR="#008000">num_nonopts</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
            <B><FONT COLOR="#000080">while</FONT></B> <FONT COLOR="#000080">(!</FONT><FONT COLOR="#008000">is_option</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">],</FONT> <FONT COLOR="#008000">only</FONT><FONT COLOR="#000080">))</FONT> <FONT COLOR="#000080">{</FONT>
                <FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">++;</FONT>
                <FONT COLOR="#008000">num_nonopts</FONT><FONT COLOR="#000080">++;</FONT>
            <FONT COLOR="#000080">}</FONT>
            <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
                <FONT COLOR="#008080">/* no more options */</FONT>
                <FONT COLOR="#008000">optind</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">permute_from</FONT><FONT COLOR="#000080">;</FONT>
                <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#008000">EOF</FONT><FONT COLOR="#000080">;</FONT>
            <FONT COLOR="#000080">}</FONT> <B><FONT COLOR="#000080">else</FONT></B> <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">strcmp</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">],</FONT> <FONT COLOR="#000000">&quot;--&quot;</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
                <FONT COLOR="#008080">/* no more options, but have to get `--' out of the way
*/</FONT>
                <FONT COLOR="#008000">permute</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#008000">permute_from</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">num_nonopts</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">);</FONT>
                <FONT COLOR="#008000">optind</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">permute_from</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
                <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#008000">EOF</FONT><FONT COLOR="#000080">;</FONT>
            <FONT COLOR="#000080">}</FONT>
            <B><FONT COLOR="#000080">break</FONT></B><FONT COLOR="#000080">;</FONT>
        <B><FONT COLOR="#000080">case</FONT></B> <FONT COLOR="#008000">RETURN_IN_ORDER</FONT><FONT COLOR="#000080">:</FONT>
            <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(!</FONT><FONT COLOR="#008000">is_option</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">],</FONT> <FONT COLOR="#008000">only</FONT><FONT COLOR="#000080">))</FONT> <FONT COLOR="#000080">{</FONT>
                <FONT COLOR="#008000">optarg</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">++];</FONT>
                <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">optopt</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">);</FONT>
            <FONT COLOR="#000080">}</FONT>
            <B><FONT COLOR="#000080">break</FONT></B><FONT COLOR="#000080">;</FONT>
        <B><FONT COLOR="#000080">case</FONT></B> <FONT COLOR="#008000">REQUIRE_ORDER</FONT><FONT COLOR="#000080">:</FONT>
            <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(!</FONT><FONT COLOR="#008000">is_option</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">],</FONT> <FONT COLOR="#008000">only</FONT><FONT COLOR="#000080">))</FONT>
                <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#008000">EOF</FONT><FONT COLOR="#000080">;</FONT>
            <B><FONT COLOR="#000080">break</FONT></B><FONT COLOR="#000080">;</FONT>
        <FONT COLOR="#000080">}</FONT>
    <FONT COLOR="#000080">}</FONT>
    <FONT COLOR="#008080">/* we've got an option, so parse it */</FONT>

    <FONT COLOR="#008080">/* first, is it a long option? */</FONT>
    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">longopts</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">NULL</FONT>
        <FONT COLOR="#000080">&amp;&amp;</FONT> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">memcmp</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">],</FONT> <FONT COLOR="#000000">&quot;--&quot;</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000"><B>2</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>0</B></FONT>
            <FONT COLOR="#000080">||</FONT> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">only</FONT> <FONT COLOR="#000080">&amp;&amp;</FONT> <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">][</FONT><FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>'+'</B></FONT><FONT COLOR="#000080">))</FONT>
        <FONT COLOR="#000080">&amp;&amp;</FONT> <FONT COLOR="#008000">optwhere</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
        <FONT COLOR="#008080">/* handle long options */</FONT>
        <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">memcmp</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">],</FONT> <FONT COLOR="#000000">&quot;--&quot;</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000"><B>2</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">)</FONT>
            <FONT COLOR="#008000">optwhere</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>2</B></FONT><FONT COLOR="#000080">;</FONT>
        <FONT COLOR="#008000">longopt_match</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000080">-</FONT><FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
        <FONT COLOR="#008000">possible_arg</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">strchr</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#008000">optwhere</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000"><B>'='</B></FONT><FONT COLOR="#000080">);</FONT>
        <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">possible_arg</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
            <FONT COLOR="#008080">/* no =, so next argv might be arg */</FONT>
            <FONT COLOR="#008000">match_chars</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">strlen</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">]);</FONT>
            <FONT COLOR="#008000">possible_arg</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#008000">match_chars</FONT><FONT COLOR="#000080">;</FONT>
            <FONT COLOR="#008000">match_chars</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">match_chars</FONT> <FONT COLOR="#000080">-</FONT> <FONT COLOR="#008000">optwhere</FONT><FONT COLOR="#000080">;</FONT>
        <FONT COLOR="#000080">}</FONT>
        <B><FONT COLOR="#000080">else</FONT></B>
            <FONT COLOR="#008000">match_chars</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">possible_arg</FONT> <FONT COLOR="#000080">-</FONT> <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">])</FONT> <FONT COLOR="#000080">-</FONT> <FONT COLOR="#008000">optwhere</FONT><FONT COLOR="#000080">;</FONT>
        <B><FONT COLOR="#000080">for</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">optindex</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT> <FONT COLOR="#008000">longopts</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optindex</FONT><FONT COLOR="#000080">].</FONT><FONT COLOR="#008000">name</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">;</FONT> <FONT COLOR="#008000">optindex</FONT><FONT COLOR="#000080">++)</FONT>
<FONT COLOR="#000080">{</FONT>
            <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">memcmp</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#008000">optwhere</FONT><FONT COLOR="#000080">,</FONT>
                       <FONT COLOR="#008000">longopts</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optindex</FONT><FONT COLOR="#000080">].</FONT><FONT COLOR="#008000">name</FONT><FONT COLOR="#000080">,</FONT>
                       <FONT COLOR="#008000">match_chars</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
                <FONT COLOR="#008080">/* do we have an exact match? */</FONT>
                <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">match_chars</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">int</FONT></B><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">strlen</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">longopts</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optindex</FONT><FONT COLOR="#000080">].</FONT><FONT COLOR="#008000">name</FONT><FONT COLOR="#000080">)))</FONT> <FONT COLOR="#000080">{</FONT>
                    <FONT COLOR="#008000">longopt_match</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">optindex</FONT><FONT COLOR="#000080">;</FONT>
                    <B><FONT COLOR="#000080">break</FONT></B><FONT COLOR="#000080">;</FONT>
                <FONT COLOR="#000080">}</FONT>
                <FONT COLOR="#008080">/* do any characters match? */</FONT>
                <B><FONT COLOR="#000080">else</FONT></B> <FONT COLOR="#000080">{</FONT>
                    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">longopt_match</FONT> <FONT COLOR="#000080">&lt;</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">)</FONT>
                        <FONT COLOR="#008000">longopt_match</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">optindex</FONT><FONT COLOR="#000080">;</FONT>
                    <B><FONT COLOR="#000080">else</FONT></B> <FONT COLOR="#000080">{</FONT>
                        <FONT COLOR="#008080">/* we have ambiguous options */</FONT>
                        <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">opterr</FONT><FONT COLOR="#000080">)</FONT>
                            <FONT COLOR="#008000">fprintf</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">stderr</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000">&quot;%s: option `%s' is
ambiguous &quot;</FONT>
                                    <FONT COLOR="#000000">&quot;(could be `--%s' or `--%s')\n&quot;</FONT><FONT COLOR="#000080">,</FONT>
                                    <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">],</FONT>
                                    <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">],</FONT>
                                    <FONT COLOR="#008000">longopts</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">longopt_match</FONT><FONT COLOR="#000080">].</FONT><FONT COLOR="#008000">name</FONT><FONT COLOR="#000080">,</FONT>
                                    <FONT COLOR="#008000">longopts</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optindex</FONT><FONT COLOR="#000080">].</FONT><FONT COLOR="#008000">name</FONT><FONT COLOR="#000080">);</FONT>
                        <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">optopt</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>'?'</B></FONT><FONT COLOR="#000080">);</FONT>
                    <FONT COLOR="#000080">}</FONT>
                <FONT COLOR="#000080">}</FONT>
            <FONT COLOR="#000080">}</FONT>
        <FONT COLOR="#000080">}</FONT>
        <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">longopt_match</FONT> <FONT COLOR="#000080">&gt;=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">)</FONT>
            <FONT COLOR="#008000">has_arg</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">longopts</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">longopt_match</FONT><FONT COLOR="#000080">].</FONT><FONT COLOR="#008000">has_arg</FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#000080">}</FONT>
    <FONT COLOR="#008080">/* if we didn't find a long option, is it a short option? */</FONT>
    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">longopt_match</FONT> <FONT COLOR="#000080">&lt;</FONT> <FONT COLOR="#000000"><B>0</B></FONT> <FONT COLOR="#000080">&amp;&amp;</FONT> <FONT COLOR="#008000">shortopts</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
        <FONT COLOR="#008000">cp</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">strchr</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">shortopts</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">][</FONT><FONT COLOR="#008000">optwhere</FONT><FONT COLOR="#000080">]);</FONT>
        <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">cp</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
            <FONT COLOR="#008080">/* couldn't find option in shortopts */</FONT>
            <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">opterr</FONT><FONT COLOR="#000080">)</FONT>
                <FONT COLOR="#008000">fprintf</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">stderr</FONT><FONT COLOR="#000080">,</FONT>
                        <FONT COLOR="#000000">&quot;%s: invalid option -- `-%c'\n&quot;</FONT><FONT COLOR="#000080">,</FONT>
                        <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">],</FONT>
                        <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">][</FONT><FONT COLOR="#008000">optwhere</FONT><FONT COLOR="#000080">]);</FONT>
            <FONT COLOR="#008000">optwhere</FONT><FONT COLOR="#000080">++;</FONT>
            <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">][</FONT><FONT COLOR="#008000">optwhere</FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>'\0'</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
                <FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">++;</FONT>
                <FONT COLOR="#008000">optwhere</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
            <FONT COLOR="#000080">}</FONT>
            <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">optopt</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>'?'</B></FONT><FONT COLOR="#000080">);</FONT>
        <FONT COLOR="#000080">}</FONT>
        <FONT COLOR="#008000">has_arg</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000080">((</FONT><FONT COLOR="#008000">cp</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>':'</B></FONT><FONT COLOR="#000080">)</FONT>
                   <FONT COLOR="#000080">?</FONT> <FONT COLOR="#000080">((</FONT><FONT COLOR="#008000">cp</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#000000"><B>2</B></FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>':'</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">?</FONT> <FONT COLOR="#008000">OPTIONAL_ARG</FONT> <FONT COLOR="#000080">:</FONT> <FONT COLOR="#008000">REQUIRED_ARG</FONT><FONT COLOR="#000080">)</FONT>
                   <FONT COLOR="#000080">:</FONT> <FONT COLOR="#008000">NO_ARG</FONT><FONT COLOR="#000080">);</FONT>
        <FONT COLOR="#008000">possible_arg</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#008000">optwhere</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
        <FONT COLOR="#008000">optopt</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">cp</FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#000080">}</FONT>
    <FONT COLOR="#008080">/* get argument and reset optwhere */</FONT>
    <FONT COLOR="#008000">arg_next</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">switch</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">has_arg</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
    <B><FONT COLOR="#000080">case</FONT></B> <FONT COLOR="#008000">OPTIONAL_ARG</FONT><FONT COLOR="#000080">:</FONT>
        <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(*</FONT><FONT COLOR="#008000">possible_arg</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>'='</B></FONT><FONT COLOR="#000080">)</FONT>
            <FONT COLOR="#008000">possible_arg</FONT><FONT COLOR="#000080">++;</FONT>
        <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(*</FONT><FONT COLOR="#008000">possible_arg</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#000000"><B>'\0'</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
            <FONT COLOR="#008000">optarg</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">possible_arg</FONT><FONT COLOR="#000080">;</FONT>
            <FONT COLOR="#008000">optwhere</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
        <FONT COLOR="#000080">}</FONT>
        <B><FONT COLOR="#000080">else</FONT></B>
            <FONT COLOR="#008000">optarg</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">;</FONT>
        <B><FONT COLOR="#000080">break</FONT></B><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">case</FONT></B> <FONT COLOR="#008000">REQUIRED_ARG</FONT><FONT COLOR="#000080">:</FONT>
        <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(*</FONT><FONT COLOR="#008000">possible_arg</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>'='</B></FONT><FONT COLOR="#000080">)</FONT>
            <FONT COLOR="#008000">possible_arg</FONT><FONT COLOR="#000080">++;</FONT>
        <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(*</FONT><FONT COLOR="#008000">possible_arg</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#000000"><B>'\0'</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
            <FONT COLOR="#008000">optarg</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">possible_arg</FONT><FONT COLOR="#000080">;</FONT>
            <FONT COLOR="#008000">optwhere</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
        <FONT COLOR="#000080">}</FONT>
        <B><FONT COLOR="#000080">else</FONT></B> <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">optind</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#000000"><B>1</B></FONT> <FONT COLOR="#000080">&gt;=</FONT> <FONT COLOR="#008000">argc</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
            <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">opterr</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
                <FONT COLOR="#008000">fprintf</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">stderr</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000">&quot;%s: argument required for option `&quot;</FONT><FONT COLOR="#000080">,</FONT>
                        <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">]);</FONT>
                <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">longopt_match</FONT> <FONT COLOR="#000080">&gt;=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">)</FONT>
                    <FONT COLOR="#008000">fprintf</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">stderr</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000">&quot;--%s'\n&quot;</FONT><FONT COLOR="#000080">,</FONT>
<FONT COLOR="#008000">longopts</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">longopt_match</FONT><FONT COLOR="#000080">].</FONT><FONT COLOR="#008000">name</FONT><FONT COLOR="#000080">);</FONT>
                <B><FONT COLOR="#000080">else</FONT></B>
                    <FONT COLOR="#008000">fprintf</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">stderr</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000">&quot;-%c'\n&quot;</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">cp</FONT><FONT COLOR="#000080">);</FONT>
            <FONT COLOR="#000080">}</FONT>
            <FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">++;</FONT>
            <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">optopt</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>':'</B></FONT><FONT COLOR="#000080">);</FONT>
        <FONT COLOR="#000080">}</FONT>
        <B><FONT COLOR="#000080">else</FONT></B> <FONT COLOR="#000080">{</FONT>
            <FONT COLOR="#008000">optarg</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">];</FONT>
            <FONT COLOR="#008000">arg_next</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
            <FONT COLOR="#008000">optwhere</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
        <FONT COLOR="#000080">}</FONT>
        <B><FONT COLOR="#000080">break</FONT></B><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">case</FONT></B> <FONT COLOR="#008000">NO_ARG</FONT><FONT COLOR="#000080">:</FONT>
        <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">longopt_match</FONT> <FONT COLOR="#000080">&lt;</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
            <FONT COLOR="#008000">optwhere</FONT><FONT COLOR="#000080">++;</FONT>
            <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">][</FONT><FONT COLOR="#008000">optwhere</FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>'\0'</B></FONT><FONT COLOR="#000080">)</FONT>
                <FONT COLOR="#008000">optwhere</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
        <FONT COLOR="#000080">}</FONT>
        <B><FONT COLOR="#000080">else</FONT></B>
            <FONT COLOR="#008000">optwhere</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
        <FONT COLOR="#008000">optarg</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">;</FONT>
        <B><FONT COLOR="#000080">break</FONT></B><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#000080">}</FONT>

    <FONT COLOR="#008080">/* do we have to permute or otherwise modify optind? */</FONT>
    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">ordering</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">PERMUTE</FONT> <FONT COLOR="#000080">&amp;&amp;</FONT> <FONT COLOR="#008000">optwhere</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>1</B></FONT> <FONT COLOR="#000080">&amp;&amp;</FONT> <FONT COLOR="#008000">num_nonopts</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
        <FONT COLOR="#008000">permute</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#008000">permute_from</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">num_nonopts</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000"><B>1</B></FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#008000">arg_next</FONT><FONT COLOR="#000080">);</FONT>
        <FONT COLOR="#008000">optind</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">permute_from</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#000000"><B>1</B></FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#008000">arg_next</FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#000080">}</FONT>
    <B><FONT COLOR="#000080">else</FONT></B> <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">optwhere</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">)</FONT>
        <FONT COLOR="#008000">optind</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">optind</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#000000"><B>1</B></FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#008000">arg_next</FONT><FONT COLOR="#000080">;</FONT>

    <FONT COLOR="#008080">/* finally return */</FONT>
    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">longopt_match</FONT> <FONT COLOR="#000080">&gt;=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
        <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">longind</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)</FONT>
            <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">longind</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">longopt_match</FONT><FONT COLOR="#000080">;</FONT>
        <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">longopts</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">longopt_match</FONT><FONT COLOR="#000080">].</FONT><FONT COLOR="#008000">flag</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
            <FONT COLOR="#000080">*(</FONT><FONT COLOR="#008000">longopts</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">longopt_match</FONT><FONT COLOR="#000080">].</FONT><FONT COLOR="#008000">flag</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">=</FONT>
<FONT COLOR="#008000">longopts</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">longopt_match</FONT><FONT COLOR="#000080">].</FONT><FONT COLOR="#008000">val</FONT><FONT COLOR="#000080">;</FONT>
            <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
        <FONT COLOR="#000080">}</FONT>
        <B><FONT COLOR="#000080">else</FONT></B>
            <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#008000">longopts</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">longopt_match</FONT><FONT COLOR="#000080">].</FONT><FONT COLOR="#008000">val</FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#000080">}</FONT>
    <B><FONT COLOR="#000080">else</FONT></B>
        <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#008000">optopt</FONT><FONT COLOR="#000080">;</FONT>
<FONT COLOR="#000080">}</FONT>

<B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">getopt_long</FONT><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">argc</FONT><FONT COLOR="#000080">,</FONT> <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">**</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">,</FONT> <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">shortopts</FONT><FONT COLOR="#000080">,</FONT>
                 <FONT COLOR="#008000">GETOPT_LONG_OPTION_T</FONT> <FONT COLOR="#000080">*</FONT> <FONT COLOR="#008000">longopts</FONT><FONT COLOR="#000080">,</FONT> <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">longind</FONT><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
    <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#008000">getopt_internal</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argc</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">shortopts</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">longopts</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">longind</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">);</FONT>
<FONT COLOR="#000080">}</FONT>

<B><FONT COLOR="#000080">void</FONT></B> <FONT COLOR="#008000">help</FONT><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">void</FONT></B><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
    <FONT COLOR="#008000">puts</FONT><FONT COLOR="#000080">(</FONT> <FONT COLOR="#000000">&quot;OPTIONS&quot;</FONT> <FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#008000">puts</FONT><FONT COLOR="#000080">(</FONT> <FONT COLOR="#000000">&quot;&quot;</FONT> <FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#008000">puts</FONT><FONT COLOR="#000080">(</FONT> <FONT COLOR="#000000">&quot;-i, --initial   When shrinking, make&quot;</FONT>
          <FONT COLOR="#000000">&quot; initial spaces/tabs on a line tabs&quot;</FONT> <FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#008000">puts</FONT><FONT COLOR="#000080">(</FONT> <FONT COLOR="#000000">&quot;                and expand every other&quot;</FONT>
          <FONT COLOR="#000000">&quot; tab on the line into spaces.&quot;</FONT> <FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#008000">puts</FONT><FONT COLOR="#000080">(</FONT> <FONT COLOR="#000000">&quot;-t=tablist,     &quot;</FONT>
          <FONT COLOR="#000000">&quot;Specify list of tab stops.  &quot;</FONT>
          <FONT COLOR="#000000">&quot;Default is every 8 characters.&quot;</FONT> <FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#008000">puts</FONT><FONT COLOR="#000080">(</FONT> <FONT COLOR="#000000">&quot;--tabs=tablist, &quot;</FONT>
          <FONT COLOR="#000000">&quot;The parameter tablist is a list&quot;</FONT>
          <FONT COLOR="#000000">&quot; of tab stops separated by&quot;</FONT> <FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#008000">puts</FONT><FONT COLOR="#000080">(</FONT> <FONT COLOR="#000000">&quot;-tablist        &quot;</FONT>
          <FONT COLOR="#000000">&quot;commas; if no commas are present,&quot;</FONT>
          <FONT COLOR="#000000">&quot; the program will put a&quot;</FONT> <FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#008000">puts</FONT><FONT COLOR="#000080">(</FONT> <FONT COLOR="#000000">&quot;                &quot;</FONT>
          <FONT COLOR="#000000">&quot;tab stop every x places, &quot;</FONT>
          <FONT COLOR="#000000">&quot;with x being the number in the&quot;</FONT> <FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#008000">puts</FONT><FONT COLOR="#000080">(</FONT> <FONT COLOR="#000000">&quot;                parameter.&quot;</FONT> <FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#008000">puts</FONT><FONT COLOR="#000080">(</FONT> <FONT COLOR="#000000">&quot;&quot;</FONT> <FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#008000">puts</FONT><FONT COLOR="#000080">(</FONT> <FONT COLOR="#000000">&quot;--help          Print usage message&quot;</FONT>
          <FONT COLOR="#000000">&quot; and exit successfully.&quot;</FONT> <FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#008000">puts</FONT><FONT COLOR="#000080">(</FONT> <FONT COLOR="#000000">&quot;&quot;</FONT> <FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#008000">puts</FONT><FONT COLOR="#000080">(</FONT> <FONT COLOR="#000000">&quot;--version       Print version &quot;</FONT>
          <FONT COLOR="#000000">&quot;information and exit successfully.&quot;</FONT> <FONT COLOR="#000080">);</FONT>
<FONT COLOR="#000080">}</FONT>

<B><FONT COLOR="#000080">void</FONT></B> <FONT COLOR="#008000">version</FONT><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">void</FONT></B><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
    <FONT COLOR="#008000">puts</FONT><FONT COLOR="#000080">(</FONT> <FONT COLOR="#000000">&quot;detab - expand tabs into spaces&quot;</FONT> <FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#008000">puts</FONT><FONT COLOR="#000080">(</FONT> <FONT COLOR="#000000">&quot;Version 1.0&quot;</FONT> <FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#008000">puts</FONT><FONT COLOR="#000080">(</FONT> <FONT COLOR="#000000">&quot;Written by Gregory Pietsch&quot;</FONT> <FONT COLOR="#000080">);</FONT>
<FONT COLOR="#000080">}</FONT>

<FONT COLOR="#008080">/* allocate memory, die on error */</FONT>
<B><FONT COLOR="#000080">void</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">xmalloc</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">size_t</FONT> <FONT COLOR="#008000">n</FONT><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
    <B><FONT COLOR="#000080">void</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">p</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">malloc</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">n</FONT><FONT COLOR="#000080">);</FONT>

    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">p</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
        <FONT COLOR="#008000">fprintf</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">stderr</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000">&quot;%s: out of memory\n&quot;</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">program_name</FONT><FONT COLOR="#000080">);</FONT>
        <FONT COLOR="#008000">exit</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">EXIT_FAILURE</FONT><FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#000080">}</FONT>
    <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#008000">p</FONT><FONT COLOR="#000080">;</FONT>
<FONT COLOR="#000080">}</FONT>

<FONT COLOR="#008080">/* reallocate memory, die on error */</FONT>
<B><FONT COLOR="#000080">void</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">xrealloc</FONT><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">void</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">p</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">size_t</FONT> <FONT COLOR="#008000">n</FONT><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
    <B><FONT COLOR="#000080">void</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">s</FONT><FONT COLOR="#000080">;</FONT>

    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">n</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
        <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">p</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)</FONT>
            <FONT COLOR="#008000">free</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">p</FONT><FONT COLOR="#000080">);</FONT>
        <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#000080">}</FONT>
    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">p</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)</FONT>
        <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#008000">xmalloc</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">n</FONT><FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#008000">s</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">realloc</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">p</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">n</FONT><FONT COLOR="#000080">);</FONT>
    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">s</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
        <FONT COLOR="#008000">fprintf</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">stderr</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000">&quot;%s: out of memory\n&quot;</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">program_name</FONT><FONT COLOR="#000080">);</FONT>
        <FONT COLOR="#008000">exit</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">EXIT_FAILURE</FONT><FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#000080">}</FONT>
    <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#008000">s</FONT><FONT COLOR="#000080">;</FONT>
<FONT COLOR="#000080">}</FONT>

<FONT COLOR="#008080">/* Determine the location of the first character in the string s1
 * that is not a character in s2.  The terminating null is not
 * considered part of the string.
 */</FONT>
<B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">xstrcpbrk</FONT><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">s1</FONT><FONT COLOR="#000080">,</FONT> <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">s2</FONT><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
    <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">sc1</FONT><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">sc2</FONT><FONT COLOR="#000080">;</FONT>

    <B><FONT COLOR="#000080">for</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">sc1</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">s1</FONT><FONT COLOR="#000080">;</FONT> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">sc1</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#000000"><B>'\0'</B></FONT><FONT COLOR="#000080">;</FONT> <FONT COLOR="#008000">sc1</FONT><FONT COLOR="#000080">++)</FONT>
        <B><FONT COLOR="#000080">for</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">sc2</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">s2</FONT><FONT COLOR="#000080">;;</FONT> <FONT COLOR="#008000">sc2</FONT><FONT COLOR="#000080">++)</FONT>
            <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(*</FONT><FONT COLOR="#008000">sc2</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>'\0'</B></FONT><FONT COLOR="#000080">)</FONT>
                <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#008000">sc1</FONT><FONT COLOR="#000080">;</FONT>
            <B><FONT COLOR="#000080">else</FONT></B> <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(*</FONT><FONT COLOR="#008000">sc1</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">sc2</FONT><FONT COLOR="#000080">)</FONT>
                <B><FONT COLOR="#000080">break</FONT></B><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">;</FONT>                <FONT COLOR="#008080">/* terminating nulls match */</FONT>
<FONT COLOR="#000080">}</FONT>

<FONT COLOR="#008080">/* compare function for qsort() */</FONT>
<B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">ul_cmp</FONT><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">const</FONT></B> <B><FONT COLOR="#000080">void</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">a</FONT><FONT COLOR="#000080">,</FONT> <B><FONT COLOR="#000080">const</FONT></B> <B><FONT COLOR="#000080">void</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">b</FONT><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
    <B><FONT COLOR="#000080">unsigned</FONT></B> <B><FONT COLOR="#000080">long</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">ula</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">unsigned</FONT></B> <B><FONT COLOR="#000080">long</FONT></B> <FONT COLOR="#000080">*)</FONT> <FONT COLOR="#008000">a</FONT><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">unsigned</FONT></B> <B><FONT COLOR="#000080">long</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">ulb</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">unsigned</FONT></B> <B><FONT COLOR="#000080">long</FONT></B> <FONT COLOR="#000080">*)</FONT> <FONT COLOR="#008000">b</FONT><FONT COLOR="#000080">;</FONT>

    <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#000080">(*</FONT><FONT COLOR="#008000">ula</FONT> <FONT COLOR="#000080">&lt;</FONT> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">ulb</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">?</FONT> <FONT COLOR="#000080">-</FONT><FONT COLOR="#000000"><B>1</B></FONT> <FONT COLOR="#000080">:</FONT> <FONT COLOR="#000080">(*</FONT><FONT COLOR="#008000">ula</FONT> <FONT COLOR="#000080">&gt;</FONT> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">ulb</FONT><FONT COLOR="#000080">);</FONT>
<FONT COLOR="#000080">}</FONT>

<FONT COLOR="#008080">/* handle a tab stop list -- assumes param isn't NULL */</FONT>
<B><FONT COLOR="#000080">void</FONT></B> <FONT COLOR="#008000">handle_tab_stops</FONT><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">s</FONT><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
    <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">p</FONT><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">unsigned</FONT></B> <B><FONT COLOR="#000080">long</FONT></B> <FONT COLOR="#008000">ul</FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#008000">size_t</FONT> <FONT COLOR="#008000">len</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">strlen</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">s</FONT><FONT COLOR="#000080">);</FONT>

    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">xstrcpbrk</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">s</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000">&quot;0123456789,&quot;</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
        <FONT COLOR="#008080">/* funny param */</FONT>
        <FONT COLOR="#008000">fprintf</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">stderr</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000">&quot;%s: invalid parameter\n&quot;</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">program_name</FONT><FONT COLOR="#000080">);</FONT>
        <FONT COLOR="#008000">exit</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">EXIT_FAILURE</FONT><FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#000080">}</FONT>
    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">strchr</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">s</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000"><B>','</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
        <FONT COLOR="#008000">tab_every</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">strtoul</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">s</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000"><B>10</B></FONT><FONT COLOR="#000080">);</FONT>
        <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">tab_every</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">)</FONT>
            <FONT COLOR="#008000">tab_every</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>8</B></FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#000080">}</FONT>
    <B><FONT COLOR="#000080">else</FONT></B> <FONT COLOR="#000080">{</FONT>
        <FONT COLOR="#008000">tab_stop_list</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">xrealloc</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">tab_stop_list</FONT><FONT COLOR="#000080">,</FONT>
              <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">num_tab_stops_allocked</FONT> <FONT COLOR="#000080">+=</FONT> <FONT COLOR="#008000">len</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">*</FONT> <FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">sizeof</FONT></B><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">unsigned</FONT></B>
<B><FONT COLOR="#000080">long</FONT></B><FONT COLOR="#000080">)));</FONT>
        <B><FONT COLOR="#000080">for</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">p</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">s</FONT><FONT COLOR="#000080">;</FONT> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">p</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">strtok</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">p</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000">&quot;,&quot;</FONT><FONT COLOR="#000080">))</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">;</FONT> <FONT COLOR="#008000">p</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
            <FONT COLOR="#008000">ul</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">strtoul</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">p</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000"><B>10</B></FONT><FONT COLOR="#000080">);</FONT>
            <FONT COLOR="#008000">tab_stop_list</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">num_tab_stops</FONT><FONT COLOR="#000080">++]</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">ul</FONT><FONT COLOR="#000080">;</FONT>
        <FONT COLOR="#000080">}</FONT>
        <FONT COLOR="#008000">qsort</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">tab_stop_list</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">num_tab_stops</FONT><FONT COLOR="#000080">,</FONT> <B><FONT COLOR="#000080">sizeof</FONT></B><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">unsigned</FONT></B> <B><FONT COLOR="#000080">long</FONT></B><FONT COLOR="#000080">),</FONT>
              <FONT COLOR="#008000">ul_cmp</FONT><FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#000080">}</FONT>
<FONT COLOR="#000080">}</FONT>

<B><FONT COLOR="#000080">void</FONT></B> <FONT COLOR="#008000">parse_args</FONT><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">argc</FONT><FONT COLOR="#000080">,</FONT> <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">**</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
    <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">opt</FONT><FONT COLOR="#000080">;</FONT>

    <B><FONT COLOR="#000080">do</FONT></B> <FONT COLOR="#000080">{</FONT>
        <B><FONT COLOR="#000080">switch</FONT></B> <FONT COLOR="#000080">((</FONT><FONT COLOR="#008000">opt</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">getopt_long</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argc</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">shortopts</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">longopts</FONT><FONT COLOR="#000080">,</FONT>
<FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)))</FONT> <FONT COLOR="#000080">{</FONT>
        <B><FONT COLOR="#000080">case</FONT></B> <FONT COLOR="#000000"><B>'i'</B></FONT><FONT COLOR="#000080">:</FONT>               <FONT COLOR="#008080">/* initial */</FONT>
            <FONT COLOR="#008000">flag_initial</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
            <B><FONT COLOR="#000080">break</FONT></B><FONT COLOR="#000080">;</FONT>
        <B><FONT COLOR="#000080">case</FONT></B> <FONT COLOR="#000000"><B>'t'</B></FONT><FONT COLOR="#000080">:</FONT>               <FONT COLOR="#008080">/* tab stops */</FONT>
            <FONT COLOR="#008000">handle_tab_stops</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">optarg</FONT><FONT COLOR="#000080">);</FONT>
            <B><FONT COLOR="#000080">break</FONT></B><FONT COLOR="#000080">;</FONT>
        <B><FONT COLOR="#000080">case</FONT></B> <FONT COLOR="#000000"><B>'?'</B></FONT><FONT COLOR="#000080">:</FONT>               <FONT COLOR="#008080">/* invalid option */</FONT>
            <FONT COLOR="#008000">fprintf</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">stderr</FONT><FONT COLOR="#000080">,</FONT><FONT COLOR="#000000">&quot;For help, type:\n\t%s --help\n&quot;</FONT><FONT COLOR="#000080">,</FONT>
<FONT COLOR="#008000">program_name</FONT><FONT COLOR="#000080">);</FONT>
            <FONT COLOR="#008000">exit</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">EXIT_FAILURE</FONT><FONT COLOR="#000080">);</FONT>
        <B><FONT COLOR="#000080">case</FONT></B> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">:</FONT>
        <B><FONT COLOR="#000080">case</FONT></B> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">:</FONT>
            <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">show_help</FONT> <FONT COLOR="#000080">||</FONT> <FONT COLOR="#008000">show_version</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
                <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">show_help</FONT><FONT COLOR="#000080">)</FONT>
                    <FONT COLOR="#008000">help</FONT><FONT COLOR="#000080">();</FONT>
                <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">show_version</FONT><FONT COLOR="#000080">)</FONT>
                    <FONT COLOR="#008000">version</FONT><FONT COLOR="#000080">();</FONT>
                <FONT COLOR="#008000">exit</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">EXIT_SUCCESS</FONT><FONT COLOR="#000080">);</FONT>
            <FONT COLOR="#000080">}</FONT>
            <B><FONT COLOR="#000080">break</FONT></B><FONT COLOR="#000080">;</FONT>
        <B><FONT COLOR="#000080">default</FONT></B><FONT COLOR="#000080">:</FONT>
            <B><FONT COLOR="#000080">break</FONT></B><FONT COLOR="#000080">;</FONT>
        <FONT COLOR="#000080">}</FONT>
    <FONT COLOR="#000080">}</FONT> <B><FONT COLOR="#000080">while</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">opt</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">EOF</FONT><FONT COLOR="#000080">);</FONT>
<FONT COLOR="#000080">}</FONT>

<FONT COLOR="#008080">/* output exactly n spaces */</FONT>
<B><FONT COLOR="#000080">void</FONT></B> <FONT COLOR="#008000">output_spaces</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">size_t</FONT> <FONT COLOR="#008000">n</FONT><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
    <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">x</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">n</FONT><FONT COLOR="#000080">;</FONT>                  <FONT COLOR="#008080">/* assume n is small */</FONT>

    <FONT COLOR="#008000">printf</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#000000">&quot;%*s&quot;</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">x</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000">&quot;&quot;</FONT><FONT COLOR="#000080">);</FONT>
<FONT COLOR="#000080">}</FONT>

<FONT COLOR="#008080">/* get next highest tab stop */</FONT>
<B><FONT COLOR="#000080">unsigned</FONT></B> <B><FONT COLOR="#000080">long</FONT></B> <FONT COLOR="#008000">get_next_tab</FONT><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">unsigned</FONT></B> <B><FONT COLOR="#000080">long</FONT></B> <FONT COLOR="#008000">x</FONT><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
    <FONT COLOR="#008000">size_t</FONT> <FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">;</FONT>

    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">tab_stop_list</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
        <FONT COLOR="#008080">/* use tab_every */</FONT>
        <FONT COLOR="#008000">x</FONT> <FONT COLOR="#000080">+=</FONT> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">tab_every</FONT> <FONT COLOR="#000080">-</FONT> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">x</FONT> <FONT COLOR="#000080">%</FONT> <FONT COLOR="#008000">tab_every</FONT><FONT COLOR="#000080">));</FONT>
        <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#008000">x</FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#000080">}</FONT>
    <B><FONT COLOR="#000080">else</FONT></B> <FONT COLOR="#000080">{</FONT>
        <B><FONT COLOR="#000080">for</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">i</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT> <FONT COLOR="#008000">i</FONT> <FONT COLOR="#000080">&lt;</FONT> <FONT COLOR="#008000">num_tab_stops</FONT> <FONT COLOR="#000080">&amp;&amp;</FONT> <FONT COLOR="#008000">tab_stop_list</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">&lt;=</FONT> <FONT COLOR="#008000">x</FONT><FONT COLOR="#000080">;</FONT> <FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">++);</FONT>
        <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">i</FONT> <FONT COLOR="#000080">&gt;=</FONT> <FONT COLOR="#008000">num_tab_stops</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">?</FONT> <FONT COLOR="#000000"><B>0</B></FONT> <FONT COLOR="#000080">:</FONT> <FONT COLOR="#008000">tab_stop_list</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">];</FONT>
    <FONT COLOR="#000080">}</FONT>
<FONT COLOR="#000080">}</FONT>

<FONT COLOR="#008080">/* the function that does the dirty work */</FONT>
<B><FONT COLOR="#000080">void</FONT></B> <FONT COLOR="#008000">tab</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">FILE</FONT> <FONT COLOR="#000080">*</FONT> <FONT COLOR="#008000">f</FONT><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
    <B><FONT COLOR="#000080">unsigned</FONT></B> <B><FONT COLOR="#000080">long</FONT></B> <FONT COLOR="#008000">linelength</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">c</FONT><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">in_initials</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#008000">size_t</FONT> <FONT COLOR="#008000">num_spaces</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">unsigned</FONT></B> <B><FONT COLOR="#000080">long</FONT></B> <FONT COLOR="#008000">next_tab</FONT><FONT COLOR="#000080">;</FONT>

    <B><FONT COLOR="#000080">while</FONT></B> <FONT COLOR="#000080">((</FONT><FONT COLOR="#008000">c</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">getc</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">f</FONT><FONT COLOR="#000080">))</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">EOF</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
        <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">c</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#000000"><B>' '</B></FONT> <FONT COLOR="#000080">&amp;&amp;</FONT> <FONT COLOR="#008000">c</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#000000"><B>'\t'</B></FONT> <FONT COLOR="#000080">&amp;&amp;</FONT> <FONT COLOR="#008000">num_spaces</FONT> <FONT COLOR="#000080">&gt;</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
            <FONT COLOR="#008080">/* output spaces and possible tabs */</FONT>
            <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">flag_expand</FONT>
                <FONT COLOR="#000080">||</FONT> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">flag_initial</FONT> <FONT COLOR="#000080">&amp;&amp;</FONT> <FONT COLOR="#000080">!</FONT><FONT COLOR="#008000">in_initials</FONT><FONT COLOR="#000080">)</FONT>
                <FONT COLOR="#000080">||</FONT> <FONT COLOR="#008000">num_spaces</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
                <FONT COLOR="#008080">/* output spaces anyway */</FONT>
                <FONT COLOR="#008000">output_spaces</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">num_spaces</FONT><FONT COLOR="#000080">);</FONT>
                <FONT COLOR="#008000">linelength</FONT> <FONT COLOR="#000080">+=</FONT> <FONT COLOR="#008000">num_spaces</FONT><FONT COLOR="#000080">;</FONT>
                <FONT COLOR="#008000">num_spaces</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
            <FONT COLOR="#000080">}</FONT>
            <B><FONT COLOR="#000080">else</FONT></B>
                <B><FONT COLOR="#000080">while</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">num_spaces</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
                    <FONT COLOR="#008000">next_tab</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">get_next_tab</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">linelength</FONT><FONT COLOR="#000080">);</FONT>
                    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">next_tab</FONT> <FONT COLOR="#000080">&gt;</FONT> <FONT COLOR="#000000"><B>0</B></FONT> <FONT COLOR="#000080">&amp;&amp;</FONT> <FONT COLOR="#008000">next_tab</FONT> <FONT COLOR="#000080">&lt;=</FONT> <FONT COLOR="#008000">linelength</FONT> <FONT COLOR="#000080">+</FONT>
<FONT COLOR="#008000">num_spaces</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
                        <FONT COLOR="#008080">/* output a tab */</FONT>
                        <FONT COLOR="#008000">putc</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#000000"><B>'\t'</B></FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">stdout</FONT><FONT COLOR="#000080">);</FONT>
                        <FONT COLOR="#008000">num_spaces</FONT> <FONT COLOR="#000080">-=</FONT> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">next_tab</FONT> <FONT COLOR="#000080">-</FONT> <FONT COLOR="#008000">linelength</FONT><FONT COLOR="#000080">);</FONT>
                        <FONT COLOR="#008000">linelength</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">next_tab</FONT><FONT COLOR="#000080">;</FONT>
                    <FONT COLOR="#000080">}</FONT>
                    <B><FONT COLOR="#000080">else</FONT></B> <FONT COLOR="#000080">{</FONT>
                        <FONT COLOR="#008080">/* output spaces */</FONT>
                        <FONT COLOR="#008000">output_spaces</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">num_spaces</FONT><FONT COLOR="#000080">);</FONT>
                        <FONT COLOR="#008000">linelength</FONT> <FONT COLOR="#000080">+=</FONT> <FONT COLOR="#008000">num_spaces</FONT><FONT COLOR="#000080">;</FONT>
                        <FONT COLOR="#008000">num_spaces</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
                    <FONT COLOR="#000080">}</FONT>
                <FONT COLOR="#000080">}</FONT>
        <FONT COLOR="#000080">}</FONT>
        <B><FONT COLOR="#000080">switch</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">c</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
        <B><FONT COLOR="#000080">case</FONT></B> <FONT COLOR="#000000"><B>' '</B></FONT><FONT COLOR="#000080">:</FONT>               <FONT COLOR="#008080">/* space */</FONT>
            <FONT COLOR="#008000">num_spaces</FONT><FONT COLOR="#000080">++;</FONT>
            <B><FONT COLOR="#000080">break</FONT></B><FONT COLOR="#000080">;</FONT>
        <B><FONT COLOR="#000080">case</FONT></B> <FONT COLOR="#000000"><B>'\b'</B></FONT><FONT COLOR="#000080">:</FONT>              <FONT COLOR="#008080">/* backspace */</FONT>
            <FONT COLOR="#008080">/* preserve backspaces in output; decrement length for
tabbing
             * purposes
             */</FONT>
            <FONT COLOR="#008000">putc</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">c</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">stdout</FONT><FONT COLOR="#000080">);</FONT>
            <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">linelength</FONT> <FONT COLOR="#000080">&gt;</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">)</FONT>
                <FONT COLOR="#008000">linelength</FONT><FONT COLOR="#000080">--;</FONT>
            <B><FONT COLOR="#000080">break</FONT></B><FONT COLOR="#000080">;</FONT>
        <B><FONT COLOR="#000080">case</FONT></B> <FONT COLOR="#000000"><B>'\n'</B></FONT><FONT COLOR="#000080">:</FONT>              <FONT COLOR="#008080">/* newline */</FONT>
            <FONT COLOR="#008000">putc</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">c</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">stdout</FONT><FONT COLOR="#000080">);</FONT>
            <FONT COLOR="#008000">in_initials</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
            <FONT COLOR="#008000">linelength</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
            <B><FONT COLOR="#000080">break</FONT></B><FONT COLOR="#000080">;</FONT>
        <B><FONT COLOR="#000080">case</FONT></B> <FONT COLOR="#000000"><B>'\t'</B></FONT><FONT COLOR="#000080">:</FONT>              <FONT COLOR="#008080">/* tab */</FONT>
            <FONT COLOR="#008000">next_tab</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">get_next_tab</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">linelength</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#008000">num_spaces</FONT><FONT COLOR="#000080">);</FONT>
            <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">next_tab</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
                <B><FONT COLOR="#000080">while</FONT></B> <FONT COLOR="#000080">((</FONT><FONT COLOR="#008000">next_tab</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">get_next_tab</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">linelength</FONT><FONT COLOR="#000080">))</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
                    <FONT COLOR="#008080">/* output tabs */</FONT>
                    <FONT COLOR="#008000">putc</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#000000"><B>'\t'</B></FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">stdout</FONT><FONT COLOR="#000080">);</FONT>
                    <FONT COLOR="#008000">num_spaces</FONT> <FONT COLOR="#000080">-=</FONT> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">next_tab</FONT> <FONT COLOR="#000080">-</FONT> <FONT COLOR="#008000">linelength</FONT><FONT COLOR="#000080">);</FONT>
                    <FONT COLOR="#008000">linelength</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">next_tab</FONT><FONT COLOR="#000080">;</FONT>
                <FONT COLOR="#000080">}</FONT>
                <FONT COLOR="#008080">/* output spaces */</FONT>
                <FONT COLOR="#008000">output_spaces</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">num_spaces</FONT><FONT COLOR="#000080">);</FONT>
                <FONT COLOR="#008000">num_spaces</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
                <FONT COLOR="#008000">putc</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#000000"><B>'\t'</B></FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">stdout</FONT><FONT COLOR="#000080">);</FONT>
                <FONT COLOR="#008000">linelength</FONT> <FONT COLOR="#000080">+=</FONT> <FONT COLOR="#008000">num_spaces</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
            <FONT COLOR="#000080">}</FONT>
            <B><FONT COLOR="#000080">else</FONT></B>
                <FONT COLOR="#008000">num_spaces</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">next_tab</FONT> <FONT COLOR="#000080">-</FONT> <FONT COLOR="#008000">linelength</FONT><FONT COLOR="#000080">;</FONT>
            <B><FONT COLOR="#000080">break</FONT></B><FONT COLOR="#000080">;</FONT>
        <B><FONT COLOR="#000080">default</FONT></B><FONT COLOR="#000080">:</FONT>
            <FONT COLOR="#008000">putc</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">c</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">stdout</FONT><FONT COLOR="#000080">);</FONT>
            <FONT COLOR="#008000">in_initials</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
            <FONT COLOR="#008000">linelength</FONT><FONT COLOR="#000080">++;</FONT>
            <B><FONT COLOR="#000080">break</FONT></B><FONT COLOR="#000080">;</FONT>
        <FONT COLOR="#000080">}</FONT>
    <FONT COLOR="#000080">}</FONT>
<FONT COLOR="#000080">}</FONT>

<B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">main</FONT><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">argc</FONT><FONT COLOR="#000080">,</FONT> <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">**</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
    <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#008000">FILE</FONT> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">fp</FONT><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">allocked_argvs</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">xmalloc</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argc</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">);</FONT>
    <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">**</FONT><FONT COLOR="#008000">new_argv</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">xmalloc</FONT><FONT COLOR="#000080">((</FONT><FONT COLOR="#008000">argc</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">*</FONT> <B><FONT COLOR="#000080">sizeof</FONT></B><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*));</FONT>
    <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">p</FONT><FONT COLOR="#000080">;</FONT>

    <FONT COLOR="#008000">program_name</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">];</FONT>
    <FONT COLOR="#008000">memset</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">allocked_argvs</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">argc</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">);</FONT>
    <B><FONT COLOR="#000080">for</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">i</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT> <FONT COLOR="#008000">i</FONT> <FONT COLOR="#000080">&lt;</FONT> <FONT COLOR="#008000">argc</FONT><FONT COLOR="#000080">;</FONT> <FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">++)</FONT> <FONT COLOR="#000080">{</FONT>
        <FONT COLOR="#008000">p</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">];</FONT>
        <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">isdigit</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">p</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">]))</FONT> <FONT COLOR="#000080">{</FONT>
            <FONT COLOR="#008000">new_argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">xmalloc</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">strlen</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">p</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#000000"><B>2</B></FONT><FONT COLOR="#000080">);</FONT>
            <FONT COLOR="#008000">sprintf</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">new_argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">],</FONT> <FONT COLOR="#000000">&quot;-t%s&quot;</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">p</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">);</FONT>
            <FONT COLOR="#008000">allocked_argvs</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
        <FONT COLOR="#000080">}</FONT>
        <B><FONT COLOR="#000080">else</FONT></B>
            <FONT COLOR="#008000">new_argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">p</FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#000080">}</FONT>
    <FONT COLOR="#008000">new_argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">argc</FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#008000">parse_args</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argc</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">new_argv</FONT><FONT COLOR="#000080">);</FONT>
    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">optind</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">argc</FONT><FONT COLOR="#000080">)</FONT>
        <FONT COLOR="#008000">tab</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">stdin</FONT><FONT COLOR="#000080">);</FONT>
    <B><FONT COLOR="#000080">else</FONT></B> <FONT COLOR="#000080">{</FONT>
        <B><FONT COLOR="#000080">for</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">i</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">;</FONT> <FONT COLOR="#008000">i</FONT> <FONT COLOR="#000080">&lt;</FONT> <FONT COLOR="#008000">argc</FONT><FONT COLOR="#000080">;</FONT> <FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">++)</FONT> <FONT COLOR="#000080">{</FONT>
            <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">strcmp</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">],</FONT> <FONT COLOR="#000000">&quot;-&quot;</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">)</FONT>
                <FONT COLOR="#008000">fp</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">stdin</FONT><FONT COLOR="#000080">;</FONT>
            <B><FONT COLOR="#000080">else</FONT></B> <FONT COLOR="#000080">{</FONT>
                <FONT COLOR="#008000">fp</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">fopen</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">],</FONT> <FONT COLOR="#000000">&quot;r&quot;</FONT><FONT COLOR="#000080">);</FONT>
                <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">fp</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
                    <FONT COLOR="#008000">fprintf</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">stderr</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000">&quot;%s: can't open %s\n&quot;</FONT><FONT COLOR="#000080">,</FONT>
                            <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">],</FONT> <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">]);</FONT>
                    <FONT COLOR="#008000">abort</FONT><FONT COLOR="#000080">();</FONT>
                <FONT COLOR="#000080">}</FONT>
            <FONT COLOR="#000080">}</FONT>
            <FONT COLOR="#008000">tab</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">fp</FONT><FONT COLOR="#000080">);</FONT>
            <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">fp</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">stdin</FONT><FONT COLOR="#000080">)</FONT>
                <FONT COLOR="#008000">fclose</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">fp</FONT><FONT COLOR="#000080">);</FONT>
        <FONT COLOR="#000080">}</FONT>
    <FONT COLOR="#000080">}</FONT>
    <FONT COLOR="#008080">/* free everything we can */</FONT>
    <B><FONT COLOR="#000080">for</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">i</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT> <FONT COLOR="#008000">i</FONT> <FONT COLOR="#000080">&lt;</FONT> <FONT COLOR="#008000">argc</FONT><FONT COLOR="#000080">;</FONT> <FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">++)</FONT>
        <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">allocked_argvs</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">])</FONT>
            <FONT COLOR="#008000">free</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">new_argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">]);</FONT>
    <FONT COLOR="#008000">free</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">allocked_argvs</FONT><FONT COLOR="#000080">);</FONT>
    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">tab_stop_list</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)</FONT>
        <FONT COLOR="#008000">free</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">tab_stop_list</FONT><FONT COLOR="#000080">);</FONT>
    <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#008000">EXIT_SUCCESS</FONT><FONT COLOR="#000080">;</FONT>
<FONT COLOR="#000080">}</FONT>

<FONT COLOR="#008080">/* END OF FILE detab.c */</FONT>
</pre>
</code>

<br>
Here's entab...
<br>
<code>
<pre>
<FONT COLOR="#008080">/****************************************************************************

entab.c - Source code for the detab command

AUTHOR: Gregory Pietsch

DESCRIPTION:

entab - shrinks spaces into tabs

****************************************************************************/</FONT>

<FONT COLOR="#008080">/* include files */</FONT>
<FONT COLOR="#0000FF"><B>#include &lt;stdio.h&gt;</B></FONT>
<FONT COLOR="#0000FF"><B>#include &lt;string.h&gt;</B></FONT>

<FONT COLOR="#008080">/* macros */</FONT>
<FONT COLOR="#0000FF"><B>#define NO_ARG          0</B></FONT>
<FONT COLOR="#0000FF"><B>#define REQUIRED_ARG    1</B></FONT>
<FONT COLOR="#0000FF"><B>#define OPTIONAL_ARG    2</B></FONT>

<FONT COLOR="#008080">/* types */</FONT>

<FONT COLOR="#008080">/* GETOPT_LONG_OPTION_T: The type of long option */</FONT>
<B><FONT COLOR="#000080">typedef</FONT></B> <B><FONT COLOR="#000080">struct</FONT></B> <FONT COLOR="#008000">GETOPT_LONG_OPTION_T</FONT> <FONT COLOR="#000080">{</FONT>
    <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">name</FONT><FONT COLOR="#000080">;</FONT>         <FONT COLOR="#008080">/* the name of the long option */</FONT>
    <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">has_arg</FONT><FONT COLOR="#000080">;</FONT>        <FONT COLOR="#008080">/* one of the above macros */</FONT>
    <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">flag</FONT><FONT COLOR="#000080">;</FONT>          <FONT COLOR="#008080">/* determines if getopt_long() returns a
                         * value for a long option; if it is
                         * non-NULL, 0 is returned as a function
                         * value and the value of val is stored in
                         * the area pointed to by flag.  Otherwise,
                         * val is returned. */</FONT>
    <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">val</FONT><FONT COLOR="#000080">;</FONT>            <FONT COLOR="#008080">/* determines the value to return if flag is
                         * NULL. */</FONT>
<FONT COLOR="#000080">}</FONT> <FONT COLOR="#008000">GETOPT_LONG_OPTION_T</FONT><FONT COLOR="#000080">;</FONT>

<B><FONT COLOR="#000080">typedef</FONT></B> <B><FONT COLOR="#000080">enum</FONT></B> <FONT COLOR="#008000">GETOPT_ORDERING_T</FONT> <FONT COLOR="#000080">{</FONT>
    <FONT COLOR="#008000">PERMUTE</FONT><FONT COLOR="#000080">,</FONT>
    <FONT COLOR="#008000">RETURN_IN_ORDER</FONT><FONT COLOR="#000080">,</FONT>
    <FONT COLOR="#008000">REQUIRE_ORDER</FONT>
<FONT COLOR="#000080">}</FONT> <FONT COLOR="#008000">GETOPT_ORDERING_T</FONT><FONT COLOR="#000080">;</FONT>

<FONT COLOR="#008080">/* globally-defined variables */</FONT>
<B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">optarg</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">;</FONT>
<B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">optind</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
<B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">opterr</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
<B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">optopt</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>'?'</B></FONT><FONT COLOR="#000080">;</FONT>

<FONT COLOR="#008080">/* statically-defined variables */</FONT>

<B><FONT COLOR="#000080">static</FONT></B> <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">program_name</FONT><FONT COLOR="#000080">;</FONT>
 <FONT COLOR="#008080">/* if nonzero, it means tab every x characters */</FONT>
<B><FONT COLOR="#000080">static</FONT></B> <B><FONT COLOR="#000080">unsigned</FONT></B> <B><FONT COLOR="#000080">long</FONT></B> <FONT COLOR="#008000">tab_every</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>8</B></FONT><FONT COLOR="#000080">;</FONT>
 <FONT COLOR="#008080">/* -i: only handle initial tabs/spaces */</FONT>
<B><FONT COLOR="#000080">static</FONT></B> <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">flag_initial</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
 <FONT COLOR="#008080">/* don't expand tabs into spaces */</FONT>
<B><FONT COLOR="#000080">static</FONT></B> <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">flag_expand</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
<B><FONT COLOR="#000080">static</FONT></B> <B><FONT COLOR="#000080">unsigned</FONT></B> <B><FONT COLOR="#000080">long</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">tab_stop_list</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">;</FONT>
<B><FONT COLOR="#000080">static</FONT></B> <FONT COLOR="#008000">size_t</FONT> <FONT COLOR="#008000">num_tab_stops</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
<B><FONT COLOR="#000080">static</FONT></B> <FONT COLOR="#008000">size_t</FONT> <FONT COLOR="#008000">num_tab_stops_allocked</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
<B><FONT COLOR="#000080">static</FONT></B> <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">show_help</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
<B><FONT COLOR="#000080">static</FONT></B> <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">show_version</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
<B><FONT COLOR="#000080">static</FONT></B> <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">shortopts</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000">&quot;it:&quot;</FONT><FONT COLOR="#000080">;</FONT>
<B><FONT COLOR="#000080">static</FONT></B> <FONT COLOR="#008000">GETOPT_LONG_OPTION_T</FONT> <FONT COLOR="#008000">longopts</FONT><FONT COLOR="#000080">[]</FONT> <FONT COLOR="#000080">=</FONT>
<FONT COLOR="#000080">{</FONT>
    <FONT COLOR="#000080">{</FONT><FONT COLOR="#000000">&quot;initial&quot;</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">NO_ARG</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000"><B>'i'</B></FONT><FONT COLOR="#000080">},</FONT>
    <FONT COLOR="#000080">{</FONT><FONT COLOR="#000000">&quot;tabs&quot;</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">REQUIRED_ARG</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000"><B>'t'</B></FONT><FONT COLOR="#000080">},</FONT>

    <FONT COLOR="#000080">{</FONT><FONT COLOR="#000000">&quot;help&quot;</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">NO_ARG</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000080">&amp;</FONT><FONT COLOR="#008000">show_help</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">},</FONT>
    <FONT COLOR="#000080">{</FONT><FONT COLOR="#000000">&quot;version&quot;</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">NO_ARG</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000080">&amp;</FONT><FONT COLOR="#008000">show_version</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">},</FONT>
    <FONT COLOR="#000080">{</FONT><FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">}</FONT>
<FONT COLOR="#000080">};</FONT>

<FONT COLOR="#008080">/* functions */</FONT>

<FONT COLOR="#008080">/* reverse_argv_elements:  reverses num elements starting at argv */</FONT>
<B><FONT COLOR="#000080">static</FONT></B> <B><FONT COLOR="#000080">void</FONT></B> <FONT COLOR="#008000">reverse_argv_elements</FONT><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">**</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">,</FONT> <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">num</FONT><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
    <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">tmp</FONT><FONT COLOR="#000080">;</FONT>

    <B><FONT COLOR="#000080">for</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">i</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT> <FONT COLOR="#008000">i</FONT> <FONT COLOR="#000080">&lt;</FONT> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">num</FONT> <FONT COLOR="#000080">&gt;&gt;</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">);</FONT> <FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">++)</FONT> <FONT COLOR="#000080">{</FONT>
        <FONT COLOR="#008000">tmp</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">];</FONT>
        <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">num</FONT> <FONT COLOR="#000080">-</FONT> <FONT COLOR="#008000">i</FONT> <FONT COLOR="#000080">-</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">];</FONT>
        <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">num</FONT> <FONT COLOR="#000080">-</FONT> <FONT COLOR="#008000">i</FONT> <FONT COLOR="#000080">-</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">tmp</FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#000080">}</FONT>
<FONT COLOR="#000080">}</FONT>

<FONT COLOR="#008080">/* permute: swap two blocks of argv-elements given their lengths */</FONT>
<B><FONT COLOR="#000080">static</FONT></B> <B><FONT COLOR="#000080">void</FONT></B> <FONT COLOR="#008000">permute</FONT><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">**</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">,</FONT> <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">len1</FONT><FONT COLOR="#000080">,</FONT> <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">len2</FONT><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
    <FONT COLOR="#008000">reverse_argv_elements</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">len1</FONT><FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#008000">reverse_argv_elements</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">len1</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#008000">len2</FONT><FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#008000">reverse_argv_elements</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">len2</FONT><FONT COLOR="#000080">);</FONT>
<FONT COLOR="#000080">}</FONT>

<FONT COLOR="#008080">/* is_option: is this argv-element an option or the end of the option
list? */</FONT>
<B><FONT COLOR="#000080">static</FONT></B> <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">is_option</FONT><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">argv_element</FONT><FONT COLOR="#000080">,</FONT> <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">only</FONT><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
    <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#000080">((</FONT><FONT COLOR="#008000">argv_element</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)</FONT>
            <FONT COLOR="#000080">||</FONT> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv_element</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>'-'</B></FONT><FONT COLOR="#000080">)</FONT>
            <FONT COLOR="#000080">||</FONT> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">only</FONT> <FONT COLOR="#000080">&amp;&amp;</FONT> <FONT COLOR="#008000">argv_element</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>'+'</B></FONT><FONT COLOR="#000080">));</FONT>
<FONT COLOR="#000080">}</FONT>

<FONT COLOR="#008080">/* getopt_internal:  the function that does all the dirty work */</FONT>
<B><FONT COLOR="#000080">static</FONT></B> <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">getopt_internal</FONT><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">argc</FONT><FONT COLOR="#000080">,</FONT> <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">**</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">,</FONT> <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">shortopts</FONT><FONT COLOR="#000080">,</FONT>
                 <FONT COLOR="#008000">GETOPT_LONG_OPTION_T</FONT> <FONT COLOR="#000080">*</FONT> <FONT COLOR="#008000">longopts</FONT><FONT COLOR="#000080">,</FONT> <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">longind</FONT><FONT COLOR="#000080">,</FONT> <B><FONT COLOR="#000080">int</FONT></B>
<FONT COLOR="#008000">only</FONT><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
    <FONT COLOR="#008000">GETOPT_ORDERING_T</FONT> <FONT COLOR="#008000">ordering</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">PERMUTE</FONT><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">static</FONT></B> <FONT COLOR="#008000">size_t</FONT> <FONT COLOR="#008000">optwhere</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#008000">size_t</FONT> <FONT COLOR="#008000">permute_from</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">num_nonopts</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">optindex</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#008000">size_t</FONT> <FONT COLOR="#008000">match_chars</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">possible_arg</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">longopt_match</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000080">-</FONT><FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">has_arg</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000080">-</FONT><FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">cp</FONT><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">arg_next</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>

    <FONT COLOR="#008080">/* first, deal with silly parameters and easy stuff */</FONT>
    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argc</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>0</B></FONT> <FONT COLOR="#000080">||</FONT> <FONT COLOR="#008000">argv</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">NULL</FONT> <FONT COLOR="#000080">||</FONT> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">shortopts</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">NULL</FONT> <FONT COLOR="#000080">&amp;&amp;</FONT> <FONT COLOR="#008000">longopts</FONT> <FONT COLOR="#000080">==</FONT>
<FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">))</FONT>
        <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">optopt</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>'?'</B></FONT><FONT COLOR="#000080">);</FONT>
    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">optind</FONT> <FONT COLOR="#000080">&gt;=</FONT> <FONT COLOR="#008000">argc</FONT> <FONT COLOR="#000080">||</FONT> <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)</FONT>
        <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#008000">EOF</FONT><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">strcmp</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">],</FONT> <FONT COLOR="#000000">&quot;--&quot;</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
        <FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">++;</FONT>
        <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#008000">EOF</FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#000080">}</FONT>
    <FONT COLOR="#008080">/* if this is our first time through */</FONT>
    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">optind</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">)</FONT>
        <FONT COLOR="#008000">optind</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">optwhere</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>

    <FONT COLOR="#008080">/* define ordering */</FONT>
    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">shortopts</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">NULL</FONT> <FONT COLOR="#000080">&amp;&amp;</FONT> <FONT COLOR="#000080">(*</FONT><FONT COLOR="#008000">shortopts</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>'-'</B></FONT> <FONT COLOR="#000080">||</FONT> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">shortopts</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>'+'</B></FONT><FONT COLOR="#000080">))</FONT> <FONT COLOR="#000080">{</FONT>
        <FONT COLOR="#008000">ordering</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000080">(*</FONT><FONT COLOR="#008000">shortopts</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>'-'</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">?</FONT> <FONT COLOR="#008000">RETURN_IN_ORDER</FONT> <FONT COLOR="#000080">:</FONT>
<FONT COLOR="#008000">REQUIRE_ORDER</FONT><FONT COLOR="#000080">;</FONT>
        <FONT COLOR="#008000">shortopts</FONT><FONT COLOR="#000080">++;</FONT>
    <FONT COLOR="#000080">}</FONT>
    <B><FONT COLOR="#000080">else</FONT></B>
        <FONT COLOR="#008000">ordering</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">getenv</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#000000">&quot;POSIXLY_CORRECT&quot;</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">?</FONT> <FONT COLOR="#008000">REQUIRE_ORDER</FONT> <FONT COLOR="#000080">:</FONT>
            <FONT COLOR="#008000">PERMUTE</FONT><FONT COLOR="#000080">;</FONT>

    <FONT COLOR="#008080">/*
     * based on ordering, find our next option, if we're at the
beginning of
     * one
     */</FONT>
    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">optwhere</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
        <B><FONT COLOR="#000080">switch</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">ordering</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
        <B><FONT COLOR="#000080">case</FONT></B> <FONT COLOR="#008000">PERMUTE</FONT><FONT COLOR="#000080">:</FONT>
            <FONT COLOR="#008000">permute_from</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">;</FONT>
            <FONT COLOR="#008000">num_nonopts</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
            <B><FONT COLOR="#000080">while</FONT></B> <FONT COLOR="#000080">(!</FONT><FONT COLOR="#008000">is_option</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">],</FONT> <FONT COLOR="#008000">only</FONT><FONT COLOR="#000080">))</FONT> <FONT COLOR="#000080">{</FONT>
                <FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">++;</FONT>
                <FONT COLOR="#008000">num_nonopts</FONT><FONT COLOR="#000080">++;</FONT>
            <FONT COLOR="#000080">}</FONT>
            <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
                <FONT COLOR="#008080">/* no more options */</FONT>
                <FONT COLOR="#008000">optind</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">permute_from</FONT><FONT COLOR="#000080">;</FONT>
                <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#008000">EOF</FONT><FONT COLOR="#000080">;</FONT>
            <FONT COLOR="#000080">}</FONT> <B><FONT COLOR="#000080">else</FONT></B> <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">strcmp</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">],</FONT> <FONT COLOR="#000000">&quot;--&quot;</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
                <FONT COLOR="#008080">/* no more options, but have to get `--' out of the way
*/</FONT>
                <FONT COLOR="#008000">permute</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#008000">permute_from</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">num_nonopts</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">);</FONT>
                <FONT COLOR="#008000">optind</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">permute_from</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
                <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#008000">EOF</FONT><FONT COLOR="#000080">;</FONT>
            <FONT COLOR="#000080">}</FONT>
            <B><FONT COLOR="#000080">break</FONT></B><FONT COLOR="#000080">;</FONT>
        <B><FONT COLOR="#000080">case</FONT></B> <FONT COLOR="#008000">RETURN_IN_ORDER</FONT><FONT COLOR="#000080">:</FONT>
            <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(!</FONT><FONT COLOR="#008000">is_option</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">],</FONT> <FONT COLOR="#008000">only</FONT><FONT COLOR="#000080">))</FONT> <FONT COLOR="#000080">{</FONT>
                <FONT COLOR="#008000">optarg</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">++];</FONT>
                <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">optopt</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">);</FONT>
            <FONT COLOR="#000080">}</FONT>
            <B><FONT COLOR="#000080">break</FONT></B><FONT COLOR="#000080">;</FONT>
        <B><FONT COLOR="#000080">case</FONT></B> <FONT COLOR="#008000">REQUIRE_ORDER</FONT><FONT COLOR="#000080">:</FONT>
            <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(!</FONT><FONT COLOR="#008000">is_option</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">],</FONT> <FONT COLOR="#008000">only</FONT><FONT COLOR="#000080">))</FONT>
                <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#008000">EOF</FONT><FONT COLOR="#000080">;</FONT>
            <B><FONT COLOR="#000080">break</FONT></B><FONT COLOR="#000080">;</FONT>
        <FONT COLOR="#000080">}</FONT>
    <FONT COLOR="#000080">}</FONT>
    <FONT COLOR="#008080">/* we've got an option, so parse it */</FONT>

    <FONT COLOR="#008080">/* first, is it a long option? */</FONT>
    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">longopts</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">NULL</FONT>
        <FONT COLOR="#000080">&amp;&amp;</FONT> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">memcmp</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">],</FONT> <FONT COLOR="#000000">&quot;--&quot;</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000"><B>2</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>0</B></FONT>
            <FONT COLOR="#000080">||</FONT> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">only</FONT> <FONT COLOR="#000080">&amp;&amp;</FONT> <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">][</FONT><FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>'+'</B></FONT><FONT COLOR="#000080">))</FONT>
        <FONT COLOR="#000080">&amp;&amp;</FONT> <FONT COLOR="#008000">optwhere</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
        <FONT COLOR="#008080">/* handle long options */</FONT>
        <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">memcmp</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">],</FONT> <FONT COLOR="#000000">&quot;--&quot;</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000"><B>2</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">)</FONT>
            <FONT COLOR="#008000">optwhere</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>2</B></FONT><FONT COLOR="#000080">;</FONT>
        <FONT COLOR="#008000">longopt_match</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000080">-</FONT><FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
        <FONT COLOR="#008000">possible_arg</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">strchr</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#008000">optwhere</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000"><B>'='</B></FONT><FONT COLOR="#000080">);</FONT>
        <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">possible_arg</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
            <FONT COLOR="#008080">/* no =, so next argv might be arg */</FONT>
            <FONT COLOR="#008000">match_chars</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">strlen</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">]);</FONT>
            <FONT COLOR="#008000">possible_arg</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#008000">match_chars</FONT><FONT COLOR="#000080">;</FONT>
            <FONT COLOR="#008000">match_chars</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">match_chars</FONT> <FONT COLOR="#000080">-</FONT> <FONT COLOR="#008000">optwhere</FONT><FONT COLOR="#000080">;</FONT>
        <FONT COLOR="#000080">}</FONT>
        <B><FONT COLOR="#000080">else</FONT></B>
            <FONT COLOR="#008000">match_chars</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">possible_arg</FONT> <FONT COLOR="#000080">-</FONT> <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">])</FONT> <FONT COLOR="#000080">-</FONT> <FONT COLOR="#008000">optwhere</FONT><FONT COLOR="#000080">;</FONT>
        <B><FONT COLOR="#000080">for</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">optindex</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT> <FONT COLOR="#008000">longopts</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optindex</FONT><FONT COLOR="#000080">].</FONT><FONT COLOR="#008000">name</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">;</FONT> <FONT COLOR="#008000">optindex</FONT><FONT COLOR="#000080">++)</FONT>
<FONT COLOR="#000080">{</FONT>
            <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">memcmp</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#008000">optwhere</FONT><FONT COLOR="#000080">,</FONT>
                       <FONT COLOR="#008000">longopts</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optindex</FONT><FONT COLOR="#000080">].</FONT><FONT COLOR="#008000">name</FONT><FONT COLOR="#000080">,</FONT>
                       <FONT COLOR="#008000">match_chars</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
                <FONT COLOR="#008080">/* do we have an exact match? */</FONT>
                <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">match_chars</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">int</FONT></B><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">strlen</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">longopts</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optindex</FONT><FONT COLOR="#000080">].</FONT><FONT COLOR="#008000">name</FONT><FONT COLOR="#000080">)))</FONT> <FONT COLOR="#000080">{</FONT>
                    <FONT COLOR="#008000">longopt_match</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">optindex</FONT><FONT COLOR="#000080">;</FONT>
                    <B><FONT COLOR="#000080">break</FONT></B><FONT COLOR="#000080">;</FONT>
                <FONT COLOR="#000080">}</FONT>
                <FONT COLOR="#008080">/* do any characters match? */</FONT>
                <B><FONT COLOR="#000080">else</FONT></B> <FONT COLOR="#000080">{</FONT>
                    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">longopt_match</FONT> <FONT COLOR="#000080">&lt;</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">)</FONT>
                        <FONT COLOR="#008000">longopt_match</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">optindex</FONT><FONT COLOR="#000080">;</FONT>
                    <B><FONT COLOR="#000080">else</FONT></B> <FONT COLOR="#000080">{</FONT>
                        <FONT COLOR="#008080">/* we have ambiguous options */</FONT>
                        <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">opterr</FONT><FONT COLOR="#000080">)</FONT>
                            <FONT COLOR="#008000">fprintf</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">stderr</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000">&quot;%s: option `%s' is
ambiguous &quot;</FONT>
                                    <FONT COLOR="#000000">&quot;(could be `--%s' or `--%s')\n&quot;</FONT><FONT COLOR="#000080">,</FONT>
                                    <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">],</FONT>
                                    <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">],</FONT>
                                    <FONT COLOR="#008000">longopts</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">longopt_match</FONT><FONT COLOR="#000080">].</FONT><FONT COLOR="#008000">name</FONT><FONT COLOR="#000080">,</FONT>
                                    <FONT COLOR="#008000">longopts</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optindex</FONT><FONT COLOR="#000080">].</FONT><FONT COLOR="#008000">name</FONT><FONT COLOR="#000080">);</FONT>
                        <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">optopt</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>'?'</B></FONT><FONT COLOR="#000080">);</FONT>
                    <FONT COLOR="#000080">}</FONT>
                <FONT COLOR="#000080">}</FONT>
            <FONT COLOR="#000080">}</FONT>
        <FONT COLOR="#000080">}</FONT>
        <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">longopt_match</FONT> <FONT COLOR="#000080">&gt;=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">)</FONT>
            <FONT COLOR="#008000">has_arg</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">longopts</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">longopt_match</FONT><FONT COLOR="#000080">].</FONT><FONT COLOR="#008000">has_arg</FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#000080">}</FONT>
    <FONT COLOR="#008080">/* if we didn't find a long option, is it a short option? */</FONT>
    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">longopt_match</FONT> <FONT COLOR="#000080">&lt;</FONT> <FONT COLOR="#000000"><B>0</B></FONT> <FONT COLOR="#000080">&amp;&amp;</FONT> <FONT COLOR="#008000">shortopts</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
        <FONT COLOR="#008000">cp</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">strchr</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">shortopts</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">][</FONT><FONT COLOR="#008000">optwhere</FONT><FONT COLOR="#000080">]);</FONT>
        <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">cp</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
            <FONT COLOR="#008080">/* couldn't find option in shortopts */</FONT>
            <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">opterr</FONT><FONT COLOR="#000080">)</FONT>
                <FONT COLOR="#008000">fprintf</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">stderr</FONT><FONT COLOR="#000080">,</FONT>
                        <FONT COLOR="#000000">&quot;%s: invalid option -- `-%c'\n&quot;</FONT><FONT COLOR="#000080">,</FONT>
                        <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">],</FONT>
                        <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">][</FONT><FONT COLOR="#008000">optwhere</FONT><FONT COLOR="#000080">]);</FONT>
            <FONT COLOR="#008000">optwhere</FONT><FONT COLOR="#000080">++;</FONT>
            <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">][</FONT><FONT COLOR="#008000">optwhere</FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>'\0'</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
                <FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">++;</FONT>
                <FONT COLOR="#008000">optwhere</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
            <FONT COLOR="#000080">}</FONT>
            <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">optopt</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>'?'</B></FONT><FONT COLOR="#000080">);</FONT>
        <FONT COLOR="#000080">}</FONT>
        <FONT COLOR="#008000">has_arg</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000080">((</FONT><FONT COLOR="#008000">cp</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>':'</B></FONT><FONT COLOR="#000080">)</FONT>
                   <FONT COLOR="#000080">?</FONT> <FONT COLOR="#000080">((</FONT><FONT COLOR="#008000">cp</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#000000"><B>2</B></FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>':'</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">?</FONT> <FONT COLOR="#008000">OPTIONAL_ARG</FONT> <FONT COLOR="#000080">:</FONT> <FONT COLOR="#008000">REQUIRED_ARG</FONT><FONT COLOR="#000080">)</FONT>
                   <FONT COLOR="#000080">:</FONT> <FONT COLOR="#008000">NO_ARG</FONT><FONT COLOR="#000080">);</FONT>
        <FONT COLOR="#008000">possible_arg</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#008000">optwhere</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
        <FONT COLOR="#008000">optopt</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">cp</FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#000080">}</FONT>
    <FONT COLOR="#008080">/* get argument and reset optwhere */</FONT>
    <FONT COLOR="#008000">arg_next</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">switch</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">has_arg</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
    <B><FONT COLOR="#000080">case</FONT></B> <FONT COLOR="#008000">OPTIONAL_ARG</FONT><FONT COLOR="#000080">:</FONT>
        <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(*</FONT><FONT COLOR="#008000">possible_arg</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>'='</B></FONT><FONT COLOR="#000080">)</FONT>
            <FONT COLOR="#008000">possible_arg</FONT><FONT COLOR="#000080">++;</FONT>
        <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(*</FONT><FONT COLOR="#008000">possible_arg</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#000000"><B>'\0'</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
            <FONT COLOR="#008000">optarg</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">possible_arg</FONT><FONT COLOR="#000080">;</FONT>
            <FONT COLOR="#008000">optwhere</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
        <FONT COLOR="#000080">}</FONT>
        <B><FONT COLOR="#000080">else</FONT></B>
            <FONT COLOR="#008000">optarg</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">;</FONT>
        <B><FONT COLOR="#000080">break</FONT></B><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">case</FONT></B> <FONT COLOR="#008000">REQUIRED_ARG</FONT><FONT COLOR="#000080">:</FONT>
        <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(*</FONT><FONT COLOR="#008000">possible_arg</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>'='</B></FONT><FONT COLOR="#000080">)</FONT>
            <FONT COLOR="#008000">possible_arg</FONT><FONT COLOR="#000080">++;</FONT>
        <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(*</FONT><FONT COLOR="#008000">possible_arg</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#000000"><B>'\0'</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
            <FONT COLOR="#008000">optarg</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">possible_arg</FONT><FONT COLOR="#000080">;</FONT>
            <FONT COLOR="#008000">optwhere</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
        <FONT COLOR="#000080">}</FONT>
        <B><FONT COLOR="#000080">else</FONT></B> <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">optind</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#000000"><B>1</B></FONT> <FONT COLOR="#000080">&gt;=</FONT> <FONT COLOR="#008000">argc</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
            <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">opterr</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
                <FONT COLOR="#008000">fprintf</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">stderr</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000">&quot;%s: argument required for option `&quot;</FONT><FONT COLOR="#000080">,</FONT>
                        <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">]);</FONT>
                <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">longopt_match</FONT> <FONT COLOR="#000080">&gt;=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">)</FONT>
                    <FONT COLOR="#008000">fprintf</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">stderr</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000">&quot;--%s'\n&quot;</FONT><FONT COLOR="#000080">,</FONT>
<FONT COLOR="#008000">longopts</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">longopt_match</FONT><FONT COLOR="#000080">].</FONT><FONT COLOR="#008000">name</FONT><FONT COLOR="#000080">);</FONT>
                <B><FONT COLOR="#000080">else</FONT></B>
                    <FONT COLOR="#008000">fprintf</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">stderr</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000">&quot;-%c'\n&quot;</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">cp</FONT><FONT COLOR="#000080">);</FONT>
            <FONT COLOR="#000080">}</FONT>
            <FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">++;</FONT>
            <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">optopt</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>':'</B></FONT><FONT COLOR="#000080">);</FONT>
        <FONT COLOR="#000080">}</FONT>
        <B><FONT COLOR="#000080">else</FONT></B> <FONT COLOR="#000080">{</FONT>
            <FONT COLOR="#008000">optarg</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">];</FONT>
            <FONT COLOR="#008000">arg_next</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
            <FONT COLOR="#008000">optwhere</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
        <FONT COLOR="#000080">}</FONT>
        <B><FONT COLOR="#000080">break</FONT></B><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">case</FONT></B> <FONT COLOR="#008000">NO_ARG</FONT><FONT COLOR="#000080">:</FONT>
        <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">longopt_match</FONT> <FONT COLOR="#000080">&lt;</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
            <FONT COLOR="#008000">optwhere</FONT><FONT COLOR="#000080">++;</FONT>
            <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">][</FONT><FONT COLOR="#008000">optwhere</FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>'\0'</B></FONT><FONT COLOR="#000080">)</FONT>
                <FONT COLOR="#008000">optwhere</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
        <FONT COLOR="#000080">}</FONT>
        <B><FONT COLOR="#000080">else</FONT></B>
            <FONT COLOR="#008000">optwhere</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
        <FONT COLOR="#008000">optarg</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">;</FONT>
        <B><FONT COLOR="#000080">break</FONT></B><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#000080">}</FONT>

    <FONT COLOR="#008080">/* do we have to permute or otherwise modify optind? */</FONT>
    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">ordering</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">PERMUTE</FONT> <FONT COLOR="#000080">&amp;&amp;</FONT> <FONT COLOR="#008000">optwhere</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>1</B></FONT> <FONT COLOR="#000080">&amp;&amp;</FONT> <FONT COLOR="#008000">num_nonopts</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
        <FONT COLOR="#008000">permute</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#008000">permute_from</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">num_nonopts</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000"><B>1</B></FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#008000">arg_next</FONT><FONT COLOR="#000080">);</FONT>
        <FONT COLOR="#008000">optind</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">permute_from</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#000000"><B>1</B></FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#008000">arg_next</FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#000080">}</FONT>
    <B><FONT COLOR="#000080">else</FONT></B> <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">optwhere</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">)</FONT>
        <FONT COLOR="#008000">optind</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">optind</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#000000"><B>1</B></FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#008000">arg_next</FONT><FONT COLOR="#000080">;</FONT>

    <FONT COLOR="#008080">/* finally return */</FONT>
    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">longopt_match</FONT> <FONT COLOR="#000080">&gt;=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
        <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">longind</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)</FONT>
            <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">longind</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">longopt_match</FONT><FONT COLOR="#000080">;</FONT>
        <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">longopts</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">longopt_match</FONT><FONT COLOR="#000080">].</FONT><FONT COLOR="#008000">flag</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
            <FONT COLOR="#000080">*(</FONT><FONT COLOR="#008000">longopts</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">longopt_match</FONT><FONT COLOR="#000080">].</FONT><FONT COLOR="#008000">flag</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">=</FONT>
<FONT COLOR="#008000">longopts</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">longopt_match</FONT><FONT COLOR="#000080">].</FONT><FONT COLOR="#008000">val</FONT><FONT COLOR="#000080">;</FONT>
            <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
        <FONT COLOR="#000080">}</FONT>
        <B><FONT COLOR="#000080">else</FONT></B>
            <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#008000">longopts</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">longopt_match</FONT><FONT COLOR="#000080">].</FONT><FONT COLOR="#008000">val</FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#000080">}</FONT>
    <B><FONT COLOR="#000080">else</FONT></B>
        <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#008000">optopt</FONT><FONT COLOR="#000080">;</FONT>
<FONT COLOR="#000080">}</FONT>

<B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">getopt_long</FONT><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">argc</FONT><FONT COLOR="#000080">,</FONT> <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">**</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">,</FONT> <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">shortopts</FONT><FONT COLOR="#000080">,</FONT>
                 <FONT COLOR="#008000">GETOPT_LONG_OPTION_T</FONT> <FONT COLOR="#000080">*</FONT> <FONT COLOR="#008000">longopts</FONT><FONT COLOR="#000080">,</FONT> <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">longind</FONT><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
    <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#008000">getopt_internal</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argc</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">shortopts</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">longopts</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">longind</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">);</FONT>
<FONT COLOR="#000080">}</FONT>

<B><FONT COLOR="#000080">void</FONT></B> <FONT COLOR="#008000">help</FONT><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">void</FONT></B><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
    <FONT COLOR="#008000">puts</FONT><FONT COLOR="#000080">(</FONT> <FONT COLOR="#000000">&quot;OPTIONS&quot;</FONT> <FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#008000">puts</FONT><FONT COLOR="#000080">(</FONT> <FONT COLOR="#000000">&quot;&quot;</FONT> <FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#008000">puts</FONT><FONT COLOR="#000080">(</FONT> <FONT COLOR="#000000">&quot;-i, --initial   When shrinking, make&quot;</FONT>
          <FONT COLOR="#000000">&quot; initial spaces/tabs on a line tabs&quot;</FONT> <FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#008000">puts</FONT><FONT COLOR="#000080">(</FONT> <FONT COLOR="#000000">&quot;                and expand every other&quot;</FONT>
          <FONT COLOR="#000000">&quot; tab on the line into spaces.&quot;</FONT> <FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#008000">puts</FONT><FONT COLOR="#000080">(</FONT> <FONT COLOR="#000000">&quot;-t=tablist,     &quot;</FONT>
          <FONT COLOR="#000000">&quot;Specify list of tab stops.  &quot;</FONT>
          <FONT COLOR="#000000">&quot;Default is every 8 characters.&quot;</FONT> <FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#008000">puts</FONT><FONT COLOR="#000080">(</FONT> <FONT COLOR="#000000">&quot;--tabs=tablist, &quot;</FONT>
          <FONT COLOR="#000000">&quot;The parameter tablist is a list&quot;</FONT>
          <FONT COLOR="#000000">&quot; of tab stops separated by&quot;</FONT> <FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#008000">puts</FONT><FONT COLOR="#000080">(</FONT> <FONT COLOR="#000000">&quot;-tablist        &quot;</FONT>
          <FONT COLOR="#000000">&quot;commas; if no commas are present,&quot;</FONT>
          <FONT COLOR="#000000">&quot; the program will put a&quot;</FONT> <FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#008000">puts</FONT><FONT COLOR="#000080">(</FONT> <FONT COLOR="#000000">&quot;                &quot;</FONT>
          <FONT COLOR="#000000">&quot;tab stop every x places, &quot;</FONT>
          <FONT COLOR="#000000">&quot;with x being the number in the&quot;</FONT> <FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#008000">puts</FONT><FONT COLOR="#000080">(</FONT> <FONT COLOR="#000000">&quot;                parameter.&quot;</FONT> <FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#008000">puts</FONT><FONT COLOR="#000080">(</FONT> <FONT COLOR="#000000">&quot;&quot;</FONT> <FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#008000">puts</FONT><FONT COLOR="#000080">(</FONT> <FONT COLOR="#000000">&quot;--help          Print usage message&quot;</FONT>
          <FONT COLOR="#000000">&quot; and exit successfully.&quot;</FONT> <FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#008000">puts</FONT><FONT COLOR="#000080">(</FONT> <FONT COLOR="#000000">&quot;&quot;</FONT> <FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#008000">puts</FONT><FONT COLOR="#000080">(</FONT> <FONT COLOR="#000000">&quot;--version       Print version &quot;</FONT>
          <FONT COLOR="#000000">&quot;information and exit successfully.&quot;</FONT> <FONT COLOR="#000080">);</FONT>
<FONT COLOR="#000080">}</FONT>

<B><FONT COLOR="#000080">void</FONT></B> <FONT COLOR="#008000">version</FONT><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">void</FONT></B><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
    <FONT COLOR="#008000">puts</FONT><FONT COLOR="#000080">(</FONT> <FONT COLOR="#000000">&quot;detab - expand tabs into spaces&quot;</FONT> <FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#008000">puts</FONT><FONT COLOR="#000080">(</FONT> <FONT COLOR="#000000">&quot;Version 1.0&quot;</FONT> <FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#008000">puts</FONT><FONT COLOR="#000080">(</FONT> <FONT COLOR="#000000">&quot;Written by Gregory Pietsch&quot;</FONT> <FONT COLOR="#000080">);</FONT>
<FONT COLOR="#000080">}</FONT>

<FONT COLOR="#008080">/* allocate memory, die on error */</FONT>
<B><FONT COLOR="#000080">void</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">xmalloc</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">size_t</FONT> <FONT COLOR="#008000">n</FONT><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
    <B><FONT COLOR="#000080">void</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">p</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">malloc</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">n</FONT><FONT COLOR="#000080">);</FONT>

    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">p</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
        <FONT COLOR="#008000">fprintf</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">stderr</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000">&quot;%s: out of memory\n&quot;</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">program_name</FONT><FONT COLOR="#000080">);</FONT>
        <FONT COLOR="#008000">exit</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">EXIT_FAILURE</FONT><FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#000080">}</FONT>
    <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#008000">p</FONT><FONT COLOR="#000080">;</FONT>
<FONT COLOR="#000080">}</FONT>

<FONT COLOR="#008080">/* reallocate memory, die on error */</FONT>
<B><FONT COLOR="#000080">void</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">xrealloc</FONT><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">void</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">p</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">size_t</FONT> <FONT COLOR="#008000">n</FONT><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
    <B><FONT COLOR="#000080">void</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">s</FONT><FONT COLOR="#000080">;</FONT>

    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">n</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
        <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">p</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)</FONT>
            <FONT COLOR="#008000">free</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">p</FONT><FONT COLOR="#000080">);</FONT>
        <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#000080">}</FONT>
    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">p</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)</FONT>
        <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#008000">xmalloc</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">n</FONT><FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#008000">s</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">realloc</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">p</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">n</FONT><FONT COLOR="#000080">);</FONT>
    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">s</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
        <FONT COLOR="#008000">fprintf</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">stderr</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000">&quot;%s: out of memory\n&quot;</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">program_name</FONT><FONT COLOR="#000080">);</FONT>
        <FONT COLOR="#008000">exit</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">EXIT_FAILURE</FONT><FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#000080">}</FONT>
    <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#008000">s</FONT><FONT COLOR="#000080">;</FONT>
<FONT COLOR="#000080">}</FONT>

<FONT COLOR="#008080">/* Determine the location of the first character in the string s1
 * that is not a character in s2.  The terminating null is not
 * considered part of the string.
 */</FONT>
<B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">xstrcpbrk</FONT><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">s1</FONT><FONT COLOR="#000080">,</FONT> <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">s2</FONT><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
    <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">sc1</FONT><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">sc2</FONT><FONT COLOR="#000080">;</FONT>

    <B><FONT COLOR="#000080">for</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">sc1</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">s1</FONT><FONT COLOR="#000080">;</FONT> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">sc1</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#000000"><B>'\0'</B></FONT><FONT COLOR="#000080">;</FONT> <FONT COLOR="#008000">sc1</FONT><FONT COLOR="#000080">++)</FONT>
        <B><FONT COLOR="#000080">for</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">sc2</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">s2</FONT><FONT COLOR="#000080">;;</FONT> <FONT COLOR="#008000">sc2</FONT><FONT COLOR="#000080">++)</FONT>
            <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(*</FONT><FONT COLOR="#008000">sc2</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>'\0'</B></FONT><FONT COLOR="#000080">)</FONT>
                <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#008000">sc1</FONT><FONT COLOR="#000080">;</FONT>
            <B><FONT COLOR="#000080">else</FONT></B> <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(*</FONT><FONT COLOR="#008000">sc1</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">sc2</FONT><FONT COLOR="#000080">)</FONT>
                <B><FONT COLOR="#000080">break</FONT></B><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">;</FONT>                <FONT COLOR="#008080">/* terminating nulls match */</FONT>
<FONT COLOR="#000080">}</FONT>

<FONT COLOR="#008080">/* compare function for qsort() */</FONT>
<B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">ul_cmp</FONT><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">const</FONT></B> <B><FONT COLOR="#000080">void</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">a</FONT><FONT COLOR="#000080">,</FONT> <B><FONT COLOR="#000080">const</FONT></B> <B><FONT COLOR="#000080">void</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">b</FONT><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
    <B><FONT COLOR="#000080">unsigned</FONT></B> <B><FONT COLOR="#000080">long</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">ula</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">unsigned</FONT></B> <B><FONT COLOR="#000080">long</FONT></B> <FONT COLOR="#000080">*)</FONT> <FONT COLOR="#008000">a</FONT><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">unsigned</FONT></B> <B><FONT COLOR="#000080">long</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">ulb</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">unsigned</FONT></B> <B><FONT COLOR="#000080">long</FONT></B> <FONT COLOR="#000080">*)</FONT> <FONT COLOR="#008000">b</FONT><FONT COLOR="#000080">;</FONT>

    <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#000080">(*</FONT><FONT COLOR="#008000">ula</FONT> <FONT COLOR="#000080">&lt;</FONT> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">ulb</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">?</FONT> <FONT COLOR="#000080">-</FONT><FONT COLOR="#000000"><B>1</B></FONT> <FONT COLOR="#000080">:</FONT> <FONT COLOR="#000080">(*</FONT><FONT COLOR="#008000">ula</FONT> <FONT COLOR="#000080">&gt;</FONT> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">ulb</FONT><FONT COLOR="#000080">);</FONT>
<FONT COLOR="#000080">}</FONT>

<FONT COLOR="#008080">/* handle a tab stop list -- assumes param isn't NULL */</FONT>
<B><FONT COLOR="#000080">void</FONT></B> <FONT COLOR="#008000">handle_tab_stops</FONT><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">s</FONT><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
    <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">p</FONT><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">unsigned</FONT></B> <B><FONT COLOR="#000080">long</FONT></B> <FONT COLOR="#008000">ul</FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#008000">size_t</FONT> <FONT COLOR="#008000">len</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">strlen</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">s</FONT><FONT COLOR="#000080">);</FONT>

    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">xstrcpbrk</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">s</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000">&quot;0123456789,&quot;</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
        <FONT COLOR="#008080">/* funny param */</FONT>
        <FONT COLOR="#008000">fprintf</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">stderr</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000">&quot;%s: invalid parameter\n&quot;</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">program_name</FONT><FONT COLOR="#000080">);</FONT>
        <FONT COLOR="#008000">exit</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">EXIT_FAILURE</FONT><FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#000080">}</FONT>
    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">strchr</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">s</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000"><B>','</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
        <FONT COLOR="#008000">tab_every</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">strtoul</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">s</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000"><B>10</B></FONT><FONT COLOR="#000080">);</FONT>
        <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">tab_every</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">)</FONT>
            <FONT COLOR="#008000">tab_every</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>8</B></FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#000080">}</FONT>
    <B><FONT COLOR="#000080">else</FONT></B> <FONT COLOR="#000080">{</FONT>
        <FONT COLOR="#008000">tab_stop_list</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">xrealloc</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">tab_stop_list</FONT><FONT COLOR="#000080">,</FONT>
              <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">num_tab_stops_allocked</FONT> <FONT COLOR="#000080">+=</FONT> <FONT COLOR="#008000">len</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">*</FONT> <FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">sizeof</FONT></B><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">unsigned</FONT></B>
<B><FONT COLOR="#000080">long</FONT></B><FONT COLOR="#000080">)));</FONT>
        <B><FONT COLOR="#000080">for</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">p</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">s</FONT><FONT COLOR="#000080">;</FONT> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">p</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">strtok</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">p</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000">&quot;,&quot;</FONT><FONT COLOR="#000080">))</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">;</FONT> <FONT COLOR="#008000">p</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
            <FONT COLOR="#008000">ul</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">strtoul</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">p</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000"><B>10</B></FONT><FONT COLOR="#000080">);</FONT>
            <FONT COLOR="#008000">tab_stop_list</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">num_tab_stops</FONT><FONT COLOR="#000080">++]</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">ul</FONT><FONT COLOR="#000080">;</FONT>
        <FONT COLOR="#000080">}</FONT>
        <FONT COLOR="#008000">qsort</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">tab_stop_list</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">num_tab_stops</FONT><FONT COLOR="#000080">,</FONT> <B><FONT COLOR="#000080">sizeof</FONT></B><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">unsigned</FONT></B> <B><FONT COLOR="#000080">long</FONT></B><FONT COLOR="#000080">),</FONT>
              <FONT COLOR="#008000">ul_cmp</FONT><FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#000080">}</FONT>
<FONT COLOR="#000080">}</FONT>

<B><FONT COLOR="#000080">void</FONT></B> <FONT COLOR="#008000">parse_args</FONT><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">argc</FONT><FONT COLOR="#000080">,</FONT> <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">**</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
    <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">opt</FONT><FONT COLOR="#000080">;</FONT>

    <B><FONT COLOR="#000080">do</FONT></B> <FONT COLOR="#000080">{</FONT>
        <B><FONT COLOR="#000080">switch</FONT></B> <FONT COLOR="#000080">((</FONT><FONT COLOR="#008000">opt</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">getopt_long</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argc</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">shortopts</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">longopts</FONT><FONT COLOR="#000080">,</FONT>
<FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)))</FONT> <FONT COLOR="#000080">{</FONT>
        <B><FONT COLOR="#000080">case</FONT></B> <FONT COLOR="#000000"><B>'i'</B></FONT><FONT COLOR="#000080">:</FONT>               <FONT COLOR="#008080">/* initial */</FONT>
            <FONT COLOR="#008000">flag_initial</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
            <B><FONT COLOR="#000080">break</FONT></B><FONT COLOR="#000080">;</FONT>
        <B><FONT COLOR="#000080">case</FONT></B> <FONT COLOR="#000000"><B>'t'</B></FONT><FONT COLOR="#000080">:</FONT>               <FONT COLOR="#008080">/* tab stops */</FONT>
            <FONT COLOR="#008000">handle_tab_stops</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">optarg</FONT><FONT COLOR="#000080">);</FONT>
            <B><FONT COLOR="#000080">break</FONT></B><FONT COLOR="#000080">;</FONT>
        <B><FONT COLOR="#000080">case</FONT></B> <FONT COLOR="#000000"><B>'?'</B></FONT><FONT COLOR="#000080">:</FONT>               <FONT COLOR="#008080">/* invalid option */</FONT>
            <FONT COLOR="#008000">fprintf</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">stderr</FONT><FONT COLOR="#000080">,</FONT><FONT COLOR="#000000">&quot;For help, type:\n\t%s --help\n&quot;</FONT><FONT COLOR="#000080">,</FONT>
<FONT COLOR="#008000">program_name</FONT><FONT COLOR="#000080">);</FONT>
            <FONT COLOR="#008000">exit</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">EXIT_FAILURE</FONT><FONT COLOR="#000080">);</FONT>
        <B><FONT COLOR="#000080">case</FONT></B> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">:</FONT>
        <B><FONT COLOR="#000080">case</FONT></B> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">:</FONT>
            <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">show_help</FONT> <FONT COLOR="#000080">||</FONT> <FONT COLOR="#008000">show_version</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
                <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">show_help</FONT><FONT COLOR="#000080">)</FONT>
                    <FONT COLOR="#008000">help</FONT><FONT COLOR="#000080">();</FONT>
                <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">show_version</FONT><FONT COLOR="#000080">)</FONT>
                    <FONT COLOR="#008000">version</FONT><FONT COLOR="#000080">();</FONT>
                <FONT COLOR="#008000">exit</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">EXIT_SUCCESS</FONT><FONT COLOR="#000080">);</FONT>
            <FONT COLOR="#000080">}</FONT>
            <B><FONT COLOR="#000080">break</FONT></B><FONT COLOR="#000080">;</FONT>
        <B><FONT COLOR="#000080">default</FONT></B><FONT COLOR="#000080">:</FONT>
            <B><FONT COLOR="#000080">break</FONT></B><FONT COLOR="#000080">;</FONT>
        <FONT COLOR="#000080">}</FONT>
    <FONT COLOR="#000080">}</FONT> <B><FONT COLOR="#000080">while</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">opt</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">EOF</FONT><FONT COLOR="#000080">);</FONT>
<FONT COLOR="#000080">}</FONT>

<FONT COLOR="#008080">/* output exactly n spaces */</FONT>
<B><FONT COLOR="#000080">void</FONT></B> <FONT COLOR="#008000">output_spaces</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">size_t</FONT> <FONT COLOR="#008000">n</FONT><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
    <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">x</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">n</FONT><FONT COLOR="#000080">;</FONT>                  <FONT COLOR="#008080">/* assume n is small */</FONT>

    <FONT COLOR="#008000">printf</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#000000">&quot;%*s&quot;</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">x</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000">&quot;&quot;</FONT><FONT COLOR="#000080">);</FONT>
<FONT COLOR="#000080">}</FONT>

<FONT COLOR="#008080">/* get next highest tab stop */</FONT>
<B><FONT COLOR="#000080">unsigned</FONT></B> <B><FONT COLOR="#000080">long</FONT></B> <FONT COLOR="#008000">get_next_tab</FONT><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">unsigned</FONT></B> <B><FONT COLOR="#000080">long</FONT></B> <FONT COLOR="#008000">x</FONT><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
    <FONT COLOR="#008000">size_t</FONT> <FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">;</FONT>

    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">tab_stop_list</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
        <FONT COLOR="#008080">/* use tab_every */</FONT>
        <FONT COLOR="#008000">x</FONT> <FONT COLOR="#000080">+=</FONT> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">tab_every</FONT> <FONT COLOR="#000080">-</FONT> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">x</FONT> <FONT COLOR="#000080">%</FONT> <FONT COLOR="#008000">tab_every</FONT><FONT COLOR="#000080">));</FONT>
        <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#008000">x</FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#000080">}</FONT>
    <B><FONT COLOR="#000080">else</FONT></B> <FONT COLOR="#000080">{</FONT>
        <B><FONT COLOR="#000080">for</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">i</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT> <FONT COLOR="#008000">i</FONT> <FONT COLOR="#000080">&lt;</FONT> <FONT COLOR="#008000">num_tab_stops</FONT> <FONT COLOR="#000080">&amp;&amp;</FONT> <FONT COLOR="#008000">tab_stop_list</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">&lt;=</FONT> <FONT COLOR="#008000">x</FONT><FONT COLOR="#000080">;</FONT> <FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">++);</FONT>
        <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">i</FONT> <FONT COLOR="#000080">&gt;=</FONT> <FONT COLOR="#008000">num_tab_stops</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">?</FONT> <FONT COLOR="#000000"><B>0</B></FONT> <FONT COLOR="#000080">:</FONT> <FONT COLOR="#008000">tab_stop_list</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">];</FONT>
    <FONT COLOR="#000080">}</FONT>
<FONT COLOR="#000080">}</FONT>

<FONT COLOR="#008080">/* the function that does the dirty work */</FONT>
<B><FONT COLOR="#000080">void</FONT></B> <FONT COLOR="#008000">tab</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">FILE</FONT> <FONT COLOR="#000080">*</FONT> <FONT COLOR="#008000">f</FONT><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
    <B><FONT COLOR="#000080">unsigned</FONT></B> <B><FONT COLOR="#000080">long</FONT></B> <FONT COLOR="#008000">linelength</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">c</FONT><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">in_initials</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#008000">size_t</FONT> <FONT COLOR="#008000">num_spaces</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">unsigned</FONT></B> <B><FONT COLOR="#000080">long</FONT></B> <FONT COLOR="#008000">next_tab</FONT><FONT COLOR="#000080">;</FONT>

    <B><FONT COLOR="#000080">while</FONT></B> <FONT COLOR="#000080">((</FONT><FONT COLOR="#008000">c</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">getc</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">f</FONT><FONT COLOR="#000080">))</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">EOF</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
        <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">c</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#000000"><B>' '</B></FONT> <FONT COLOR="#000080">&amp;&amp;</FONT> <FONT COLOR="#008000">c</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#000000"><B>'\t'</B></FONT> <FONT COLOR="#000080">&amp;&amp;</FONT> <FONT COLOR="#008000">num_spaces</FONT> <FONT COLOR="#000080">&gt;</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
            <FONT COLOR="#008080">/* output spaces and possible tabs */</FONT>
            <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">flag_expand</FONT>
                <FONT COLOR="#000080">||</FONT> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">flag_initial</FONT> <FONT COLOR="#000080">&amp;&amp;</FONT> <FONT COLOR="#000080">!</FONT><FONT COLOR="#008000">in_initials</FONT><FONT COLOR="#000080">)</FONT>
                <FONT COLOR="#000080">||</FONT> <FONT COLOR="#008000">num_spaces</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
                <FONT COLOR="#008080">/* output spaces anyway */</FONT>
                <FONT COLOR="#008000">output_spaces</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">num_spaces</FONT><FONT COLOR="#000080">);</FONT>
                <FONT COLOR="#008000">linelength</FONT> <FONT COLOR="#000080">+=</FONT> <FONT COLOR="#008000">num_spaces</FONT><FONT COLOR="#000080">;</FONT>
                <FONT COLOR="#008000">num_spaces</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
            <FONT COLOR="#000080">}</FONT>
            <B><FONT COLOR="#000080">else</FONT></B>
                <B><FONT COLOR="#000080">while</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">num_spaces</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
                    <FONT COLOR="#008000">next_tab</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">get_next_tab</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">linelength</FONT><FONT COLOR="#000080">);</FONT>
                    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">next_tab</FONT> <FONT COLOR="#000080">&gt;</FONT> <FONT COLOR="#000000"><B>0</B></FONT> <FONT COLOR="#000080">&amp;&amp;</FONT> <FONT COLOR="#008000">next_tab</FONT> <FONT COLOR="#000080">&lt;=</FONT> <FONT COLOR="#008000">linelength</FONT> <FONT COLOR="#000080">+</FONT>
<FONT COLOR="#008000">num_spaces</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
                        <FONT COLOR="#008080">/* output a tab */</FONT>
                        <FONT COLOR="#008000">putc</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#000000"><B>'\t'</B></FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">stdout</FONT><FONT COLOR="#000080">);</FONT>
                        <FONT COLOR="#008000">num_spaces</FONT> <FONT COLOR="#000080">-=</FONT> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">next_tab</FONT> <FONT COLOR="#000080">-</FONT> <FONT COLOR="#008000">linelength</FONT><FONT COLOR="#000080">);</FONT>
                        <FONT COLOR="#008000">linelength</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">next_tab</FONT><FONT COLOR="#000080">;</FONT>
                    <FONT COLOR="#000080">}</FONT>
                    <B><FONT COLOR="#000080">else</FONT></B> <FONT COLOR="#000080">{</FONT>
                        <FONT COLOR="#008080">/* output spaces */</FONT>
                        <FONT COLOR="#008000">output_spaces</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">num_spaces</FONT><FONT COLOR="#000080">);</FONT>
                        <FONT COLOR="#008000">linelength</FONT> <FONT COLOR="#000080">+=</FONT> <FONT COLOR="#008000">num_spaces</FONT><FONT COLOR="#000080">;</FONT>
                        <FONT COLOR="#008000">num_spaces</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
                    <FONT COLOR="#000080">}</FONT>
                <FONT COLOR="#000080">}</FONT>
        <FONT COLOR="#000080">}</FONT>
        <B><FONT COLOR="#000080">switch</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">c</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
        <B><FONT COLOR="#000080">case</FONT></B> <FONT COLOR="#000000"><B>' '</B></FONT><FONT COLOR="#000080">:</FONT>               <FONT COLOR="#008080">/* space */</FONT>
            <FONT COLOR="#008000">num_spaces</FONT><FONT COLOR="#000080">++;</FONT>
            <B><FONT COLOR="#000080">break</FONT></B><FONT COLOR="#000080">;</FONT>
        <B><FONT COLOR="#000080">case</FONT></B> <FONT COLOR="#000000"><B>'\b'</B></FONT><FONT COLOR="#000080">:</FONT>              <FONT COLOR="#008080">/* backspace */</FONT>
            <FONT COLOR="#008080">/* preserve backspaces in output; decrement length for
tabbing
             * purposes
             */</FONT>
            <FONT COLOR="#008000">putc</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">c</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">stdout</FONT><FONT COLOR="#000080">);</FONT>
            <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">linelength</FONT> <FONT COLOR="#000080">&gt;</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">)</FONT>
                <FONT COLOR="#008000">linelength</FONT><FONT COLOR="#000080">--;</FONT>
            <B><FONT COLOR="#000080">break</FONT></B><FONT COLOR="#000080">;</FONT>
        <B><FONT COLOR="#000080">case</FONT></B> <FONT COLOR="#000000"><B>'\n'</B></FONT><FONT COLOR="#000080">:</FONT>              <FONT COLOR="#008080">/* newline */</FONT>
            <FONT COLOR="#008000">putc</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">c</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">stdout</FONT><FONT COLOR="#000080">);</FONT>
            <FONT COLOR="#008000">in_initials</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
            <FONT COLOR="#008000">linelength</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
            <B><FONT COLOR="#000080">break</FONT></B><FONT COLOR="#000080">;</FONT>
        <B><FONT COLOR="#000080">case</FONT></B> <FONT COLOR="#000000"><B>'\t'</B></FONT><FONT COLOR="#000080">:</FONT>              <FONT COLOR="#008080">/* tab */</FONT>
            <FONT COLOR="#008000">next_tab</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">get_next_tab</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">linelength</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#008000">num_spaces</FONT><FONT COLOR="#000080">);</FONT>
            <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">next_tab</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
                <B><FONT COLOR="#000080">while</FONT></B> <FONT COLOR="#000080">((</FONT><FONT COLOR="#008000">next_tab</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">get_next_tab</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">linelength</FONT><FONT COLOR="#000080">))</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
                    <FONT COLOR="#008080">/* output tabs */</FONT>
                    <FONT COLOR="#008000">putc</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#000000"><B>'\t'</B></FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">stdout</FONT><FONT COLOR="#000080">);</FONT>
                    <FONT COLOR="#008000">num_spaces</FONT> <FONT COLOR="#000080">-=</FONT> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">next_tab</FONT> <FONT COLOR="#000080">-</FONT> <FONT COLOR="#008000">linelength</FONT><FONT COLOR="#000080">);</FONT>
                    <FONT COLOR="#008000">linelength</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">next_tab</FONT><FONT COLOR="#000080">;</FONT>
                <FONT COLOR="#000080">}</FONT>
                <FONT COLOR="#008080">/* output spaces */</FONT>
                <FONT COLOR="#008000">output_spaces</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">num_spaces</FONT><FONT COLOR="#000080">);</FONT>
                <FONT COLOR="#008000">num_spaces</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
                <FONT COLOR="#008000">putc</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#000000"><B>'\t'</B></FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">stdout</FONT><FONT COLOR="#000080">);</FONT>
                <FONT COLOR="#008000">linelength</FONT> <FONT COLOR="#000080">+=</FONT> <FONT COLOR="#008000">num_spaces</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
            <FONT COLOR="#000080">}</FONT>
            <B><FONT COLOR="#000080">else</FONT></B>
                <FONT COLOR="#008000">num_spaces</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">next_tab</FONT> <FONT COLOR="#000080">-</FONT> <FONT COLOR="#008000">linelength</FONT><FONT COLOR="#000080">;</FONT>
            <B><FONT COLOR="#000080">break</FONT></B><FONT COLOR="#000080">;</FONT>
        <B><FONT COLOR="#000080">default</FONT></B><FONT COLOR="#000080">:</FONT>
            <FONT COLOR="#008000">putc</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">c</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">stdout</FONT><FONT COLOR="#000080">);</FONT>
            <FONT COLOR="#008000">in_initials</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
            <FONT COLOR="#008000">linelength</FONT><FONT COLOR="#000080">++;</FONT>
            <B><FONT COLOR="#000080">break</FONT></B><FONT COLOR="#000080">;</FONT>
        <FONT COLOR="#000080">}</FONT>
    <FONT COLOR="#000080">}</FONT>
<FONT COLOR="#000080">}</FONT>

<B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">main</FONT><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">argc</FONT><FONT COLOR="#000080">,</FONT> <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">**</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
    <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#008000">FILE</FONT> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">fp</FONT><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">allocked_argvs</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">xmalloc</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argc</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">);</FONT>
    <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">**</FONT><FONT COLOR="#008000">new_argv</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">xmalloc</FONT><FONT COLOR="#000080">((</FONT><FONT COLOR="#008000">argc</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">*</FONT> <B><FONT COLOR="#000080">sizeof</FONT></B><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*));</FONT>
    <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">p</FONT><FONT COLOR="#000080">;</FONT>

    <FONT COLOR="#008000">program_name</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">];</FONT>
    <FONT COLOR="#008000">memset</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">allocked_argvs</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">argc</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">);</FONT>
    <B><FONT COLOR="#000080">for</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">i</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT> <FONT COLOR="#008000">i</FONT> <FONT COLOR="#000080">&lt;</FONT> <FONT COLOR="#008000">argc</FONT><FONT COLOR="#000080">;</FONT> <FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">++)</FONT> <FONT COLOR="#000080">{</FONT>
        <FONT COLOR="#008000">p</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">];</FONT>
        <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">isdigit</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">p</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">]))</FONT> <FONT COLOR="#000080">{</FONT>
            <FONT COLOR="#008000">new_argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">xmalloc</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">strlen</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">p</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#000000"><B>2</B></FONT><FONT COLOR="#000080">);</FONT>
            <FONT COLOR="#008000">sprintf</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">new_argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">],</FONT> <FONT COLOR="#000000">&quot;-t%s&quot;</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">p</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">);</FONT>
            <FONT COLOR="#008000">allocked_argvs</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
        <FONT COLOR="#000080">}</FONT>
        <B><FONT COLOR="#000080">else</FONT></B>
            <FONT COLOR="#008000">new_argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">p</FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#000080">}</FONT>
    <FONT COLOR="#008000">new_argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">argc</FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#008000">parse_args</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argc</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">new_argv</FONT><FONT COLOR="#000080">);</FONT>
    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">optind</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">argc</FONT><FONT COLOR="#000080">)</FONT>
        <FONT COLOR="#008000">tab</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">stdin</FONT><FONT COLOR="#000080">);</FONT>
    <B><FONT COLOR="#000080">else</FONT></B> <FONT COLOR="#000080">{</FONT>
        <B><FONT COLOR="#000080">for</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">i</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">optind</FONT><FONT COLOR="#000080">;</FONT> <FONT COLOR="#008000">i</FONT> <FONT COLOR="#000080">&lt;</FONT> <FONT COLOR="#008000">argc</FONT><FONT COLOR="#000080">;</FONT> <FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">++)</FONT> <FONT COLOR="#000080">{</FONT>
            <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">strcmp</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">],</FONT> <FONT COLOR="#000000">&quot;-&quot;</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">)</FONT>
                <FONT COLOR="#008000">fp</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">stdin</FONT><FONT COLOR="#000080">;</FONT>
            <B><FONT COLOR="#000080">else</FONT></B> <FONT COLOR="#000080">{</FONT>
                <FONT COLOR="#008000">fp</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">fopen</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">],</FONT> <FONT COLOR="#000000">&quot;r&quot;</FONT><FONT COLOR="#000080">);</FONT>
                <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">fp</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">{</FONT>
                    <FONT COLOR="#008000">fprintf</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">stderr</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000">&quot;%s: can't open %s\n&quot;</FONT><FONT COLOR="#000080">,</FONT>
                            <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">],</FONT> <FONT COLOR="#008000">argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">]);</FONT>
                    <FONT COLOR="#008000">abort</FONT><FONT COLOR="#000080">();</FONT>
                <FONT COLOR="#000080">}</FONT>
            <FONT COLOR="#000080">}</FONT>
            <FONT COLOR="#008000">tab</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">fp</FONT><FONT COLOR="#000080">);</FONT>
            <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">fp</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">stdin</FONT><FONT COLOR="#000080">)</FONT>
                <FONT COLOR="#008000">fclose</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">fp</FONT><FONT COLOR="#000080">);</FONT>
        <FONT COLOR="#000080">}</FONT>
    <FONT COLOR="#000080">}</FONT>
    <FONT COLOR="#008080">/* free everything we can */</FONT>
    <B><FONT COLOR="#000080">for</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">i</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT> <FONT COLOR="#008000">i</FONT> <FONT COLOR="#000080">&lt;</FONT> <FONT COLOR="#008000">argc</FONT><FONT COLOR="#000080">;</FONT> <FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">++)</FONT>
        <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">allocked_argvs</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">])</FONT>
            <FONT COLOR="#008000">free</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">new_argv</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">i</FONT><FONT COLOR="#000080">]);</FONT>
    <FONT COLOR="#008000">free</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">allocked_argvs</FONT><FONT COLOR="#000080">);</FONT>
    <B><FONT COLOR="#000080">if</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">tab_stop_list</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">)</FONT>
        <FONT COLOR="#008000">free</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">tab_stop_list</FONT><FONT COLOR="#000080">);</FONT>
    <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#008000">EXIT_SUCCESS</FONT><FONT COLOR="#000080">;</FONT>
<FONT COLOR="#000080">}</FONT>

<FONT COLOR="#008080">/* END OF FILE entab.c */</FONT>

</pre>
</code>

<br>
<br>

<a href=index.html>  Back to index </a></body></html>