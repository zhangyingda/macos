<html>
  <head>

    <title>
      The C Programming Language Exercise 6-4
    </title>

  <BODY    text="#000000"
        bgcolor="#DDDDDD"
           link="#800000"
          alink="#008000"
          vlink="#000080">


<center>
<h2>
  &quot;The C Programming Language&quot;, 2nd edition, Kernighan and Ritchie
</h2>
<h3>
  Answer to Exercise 6-4, page 143
</h3>
<h4>
  Solution by <a href=mailto:gfd34@dial.pipex.com>  Bryan Williams </a>
</h4>
</center>

<i>
Write a program that prints the distinct words in its input sorted
into decreasing order of frequency of occurrence. Precede each word
by its count.
</i>
<br>
<br>
Bryan's solution is, as far as I can tell, Category 1 only because
he uses <code>EXIT_SUCCESS</code> and <code>EXIT_FAILURE</code> .
<br>
<br>
<code>
<pre>
<FONT COLOR="#008080">/*

  Chapter 6. Structures

          Write a program that prints out the distinct words in its 
          input sorted into decreasing order of frequency of occurrence.
          Precede each word by its count.

  Author: Bryan Williams

*/</FONT>

<FONT COLOR="#0000FF"><B>#include &lt;stdlib.h&gt;</B></FONT>
<FONT COLOR="#0000FF"><B>#include &lt;stdio.h&gt;</B></FONT>
<FONT COLOR="#0000FF"><B>#include &lt;string.h&gt;</B></FONT>

<FONT COLOR="#0000FF"><B>#include &lt;assert.h&gt;</B></FONT>


<B><FONT COLOR="#000080">typedef</FONT></B> <B><FONT COLOR="#000080">struct</FONT></B> <FONT COLOR="#008000">WORD</FONT>
<FONT COLOR="#000080">{</FONT>
  <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">Word</FONT><FONT COLOR="#000080">;</FONT>
  <FONT COLOR="#008000">size_t</FONT> <FONT COLOR="#008000">Count</FONT><FONT COLOR="#000080">;</FONT>
  <B><FONT COLOR="#000080">struct</FONT></B> <FONT COLOR="#008000">WORD</FONT> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">Left</FONT><FONT COLOR="#000080">;</FONT>
  <B><FONT COLOR="#000080">struct</FONT></B> <FONT COLOR="#008000">WORD</FONT> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">Right</FONT><FONT COLOR="#000080">;</FONT>
<FONT COLOR="#000080">}</FONT> <FONT COLOR="#008000">WORD</FONT><FONT COLOR="#000080">;</FONT>


<FONT COLOR="#008080">/*
  Assumptions: input is on stdin, output to stdout.

  Plan: read the words into a tree, keeping a count of how many we have,
        allocate an array big enough to hold Treecount (WORD *)'s 
        walk the tree to populate the array.
        qsort the array, based on size.
        printf the array
        free the array
        free the tree
        free tibet (optional)
        free international shipping!
*/</FONT>

<FONT COLOR="#0000FF"><B>#define SUCCESS                      0</B></FONT>
<FONT COLOR="#0000FF"><B>#define CANNOT_MALLOC_WORDARRAY      1</B></FONT>
<FONT COLOR="#0000FF"><B>#define NO_WORDS_ON_INPUT            2</B></FONT>
<FONT COLOR="#0000FF"><B>#define NO_MEMORY_FOR_WORDNODE       3</B></FONT>
<FONT COLOR="#0000FF"><B>#define NO_MEMORY_FOR_WORD           4</B></FONT>


<FONT COLOR="#0000FF"><B>#define NONALPHA &quot;1234567890 \v\f\n\t\r+=-*/\\,.;:'#~?&lt;&gt;|{}[]`!\&quot;ï¿½$%^&amp;()&quot;</B></FONT>

<B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">ReadInputToTree</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">WORD</FONT> <FONT COLOR="#000080">**</FONT><FONT COLOR="#008000">DestTree</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">size_t</FONT> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">Treecount</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">FILE</FONT> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">Input</FONT><FONT COLOR="#000080">);</FONT>
<B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">AddToTree</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">WORD</FONT> <FONT COLOR="#000080">**</FONT><FONT COLOR="#008000">DestTree</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">size_t</FONT> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">Treecount</FONT><FONT COLOR="#000080">,</FONT> <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">Word</FONT><FONT COLOR="#000080">);</FONT> 
<B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">WalkTree</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">WORD</FONT> <FONT COLOR="#000080">**</FONT><FONT COLOR="#008000">DestArray</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">WORD</FONT> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">Word</FONT><FONT COLOR="#000080">);</FONT>
<B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">CompareCounts</FONT><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">const</FONT></B> <B><FONT COLOR="#000080">void</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">vWord1</FONT><FONT COLOR="#000080">,</FONT> <B><FONT COLOR="#000080">const</FONT></B> <B><FONT COLOR="#000080">void</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">vWord2</FONT><FONT COLOR="#000080">);</FONT>
<B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">OutputWords</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">FILE</FONT> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">Dest</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">size_t</FONT> <FONT COLOR="#008000">Count</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">WORD</FONT> <FONT COLOR="#000080">**</FONT><FONT COLOR="#008000">WordArray</FONT><FONT COLOR="#000080">);</FONT>
<B><FONT COLOR="#000080">void</FONT></B> <FONT COLOR="#008000">FreeTree</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">WORD</FONT> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">W</FONT><FONT COLOR="#000080">);</FONT>
<B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">dupstr</FONT><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">s</FONT><FONT COLOR="#000080">);</FONT>


<B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">main</FONT><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">void</FONT></B><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
  <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">Status</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">SUCCESS</FONT><FONT COLOR="#000080">;</FONT>
  <FONT COLOR="#008000">WORD</FONT> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">Words</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">;</FONT>
  <FONT COLOR="#008000">size_t</FONT> <FONT COLOR="#008000">Treecount</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
  <FONT COLOR="#008000">WORD</FONT> <FONT COLOR="#000080">**</FONT><FONT COLOR="#008000">WordArray</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">;</FONT>

  <FONT COLOR="#008080">/* Read the words on stdin into a tree */</FONT>
  <B><FONT COLOR="#000080">if</FONT></B><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">SUCCESS</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">Status</FONT><FONT COLOR="#000080">)</FONT>
  <FONT COLOR="#000080">{</FONT>
    <FONT COLOR="#008000">Status</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">ReadInputToTree</FONT><FONT COLOR="#000080">(&amp;</FONT><FONT COLOR="#008000">Words</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000080">&amp;</FONT><FONT COLOR="#008000">Treecount</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">stdin</FONT><FONT COLOR="#000080">);</FONT>
  <FONT COLOR="#000080">}</FONT>

  <FONT COLOR="#008080">/* Sanity check for no sensible input */</FONT>
  <B><FONT COLOR="#000080">if</FONT></B><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">SUCCESS</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">Status</FONT><FONT COLOR="#000080">)</FONT>
  <FONT COLOR="#000080">{</FONT>
    <B><FONT COLOR="#000080">if</FONT></B><FONT COLOR="#000080">(</FONT><FONT COLOR="#000000"><B>0</B></FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">Treecount</FONT><FONT COLOR="#000080">)</FONT>
    <FONT COLOR="#000080">{</FONT>
      <FONT COLOR="#008000">Status</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">NO_WORDS_ON_INPUT</FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#000080">}</FONT>
  <FONT COLOR="#000080">}</FONT>

  <FONT COLOR="#008080">/* allocate a sufficiently large array */</FONT>
  <B><FONT COLOR="#000080">if</FONT></B><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">SUCCESS</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">Status</FONT><FONT COLOR="#000080">)</FONT>
  <FONT COLOR="#000080">{</FONT>
     <FONT COLOR="#008000">WordArray</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">malloc</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">Treecount</FONT> <FONT COLOR="#000080">*</FONT> <B><FONT COLOR="#000080">sizeof</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">WordArray</FONT><FONT COLOR="#000080">);</FONT>
     <B><FONT COLOR="#000080">if</FONT></B><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">NULL</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">WordArray</FONT><FONT COLOR="#000080">)</FONT>
     <FONT COLOR="#000080">{</FONT>
       <FONT COLOR="#008000">Status</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">CANNOT_MALLOC_WORDARRAY</FONT><FONT COLOR="#000080">;</FONT>
     <FONT COLOR="#000080">}</FONT> 
  <FONT COLOR="#000080">}</FONT>

  <FONT COLOR="#008080">/* Walk the tree into the array */</FONT>
  <B><FONT COLOR="#000080">if</FONT></B><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">SUCCESS</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">Status</FONT><FONT COLOR="#000080">)</FONT>
  <FONT COLOR="#000080">{</FONT>
    <FONT COLOR="#008000">Status</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">WalkTree</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">WordArray</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">Words</FONT><FONT COLOR="#000080">);</FONT>
  <FONT COLOR="#000080">}</FONT>

  <FONT COLOR="#008080">/* qsort the array */</FONT>
  <B><FONT COLOR="#000080">if</FONT></B><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">SUCCESS</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">Status</FONT><FONT COLOR="#000080">)</FONT>
  <FONT COLOR="#000080">{</FONT>
    <FONT COLOR="#008000">qsort</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">WordArray</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">Treecount</FONT><FONT COLOR="#000080">,</FONT> <B><FONT COLOR="#000080">sizeof</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">WordArray</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">CompareCounts</FONT><FONT COLOR="#000080">);</FONT>
  <FONT COLOR="#000080">}</FONT>

  <FONT COLOR="#008080">/* walk down the WordArray outputting the values */</FONT>
  <B><FONT COLOR="#000080">if</FONT></B><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">SUCCESS</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">Status</FONT><FONT COLOR="#000080">)</FONT>
  <FONT COLOR="#000080">{</FONT>
    <FONT COLOR="#008000">Status</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">OutputWords</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">stdout</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">Treecount</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">WordArray</FONT><FONT COLOR="#000080">);</FONT>
  <FONT COLOR="#000080">}</FONT>

  <FONT COLOR="#008080">/* free the word array */</FONT>
  <B><FONT COLOR="#000080">if</FONT></B><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">NULL</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">WordArray</FONT><FONT COLOR="#000080">)</FONT>
  <FONT COLOR="#000080">{</FONT>
    <FONT COLOR="#008000">free</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">WordArray</FONT><FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#008000">WordArray</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">;</FONT>
  <FONT COLOR="#000080">}</FONT>

  <FONT COLOR="#008080">/* and free the tree memory */</FONT>
  <B><FONT COLOR="#000080">if</FONT></B><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">NULL</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">Words</FONT><FONT COLOR="#000080">)</FONT>
  <FONT COLOR="#000080">{</FONT>
    <FONT COLOR="#008000">FreeTree</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">Words</FONT><FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#008000">Words</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">;</FONT>
  <FONT COLOR="#000080">}</FONT>

  <FONT COLOR="#008080">/* Error report and we are finshed */</FONT>
  <B><FONT COLOR="#000080">if</FONT></B><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">SUCCESS</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">Status</FONT><FONT COLOR="#000080">)</FONT>
  <FONT COLOR="#000080">{</FONT>
    <FONT COLOR="#008000">fprintf</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">stderr</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000">&quot;Program failed with code %d\n&quot;</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">Status</FONT><FONT COLOR="#000080">);</FONT>
  <FONT COLOR="#000080">}</FONT>
  <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">SUCCESS</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">Status</FONT> <FONT COLOR="#000080">?</FONT> <FONT COLOR="#008000">EXIT_SUCCESS</FONT> <FONT COLOR="#000080">:</FONT> <FONT COLOR="#008000">EXIT_FAILURE</FONT><FONT COLOR="#000080">);</FONT>
<FONT COLOR="#000080">}</FONT>




<B><FONT COLOR="#000080">void</FONT></B> <FONT COLOR="#008000">FreeTree</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">WORD</FONT> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">W</FONT><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
  <B><FONT COLOR="#000080">if</FONT></B><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">NULL</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">W</FONT><FONT COLOR="#000080">)</FONT>
  <FONT COLOR="#000080">{</FONT>
    <B><FONT COLOR="#000080">if</FONT></B><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">NULL</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">W</FONT><FONT COLOR="#000080">-&gt;</FONT><FONT COLOR="#008000">Word</FONT><FONT COLOR="#000080">)</FONT>
    <FONT COLOR="#000080">{</FONT> 
      <FONT COLOR="#008000">free</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">W</FONT><FONT COLOR="#000080">-&gt;</FONT><FONT COLOR="#008000">Word</FONT><FONT COLOR="#000080">);</FONT>
      <FONT COLOR="#008000">W</FONT><FONT COLOR="#000080">-&gt;</FONT><FONT COLOR="#008000">Word</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#000080">}</FONT>
    <B><FONT COLOR="#000080">if</FONT></B><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">NULL</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">W</FONT><FONT COLOR="#000080">-&gt;</FONT><FONT COLOR="#008000">Left</FONT><FONT COLOR="#000080">)</FONT>
    <FONT COLOR="#000080">{</FONT>
      <FONT COLOR="#008000">FreeTree</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">W</FONT><FONT COLOR="#000080">-&gt;</FONT><FONT COLOR="#008000">Left</FONT><FONT COLOR="#000080">);</FONT>
      <FONT COLOR="#008000">W</FONT><FONT COLOR="#000080">-&gt;</FONT><FONT COLOR="#008000">Left</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#000080">}</FONT>
    <B><FONT COLOR="#000080">if</FONT></B><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">NULL</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">W</FONT><FONT COLOR="#000080">-&gt;</FONT><FONT COLOR="#008000">Right</FONT><FONT COLOR="#000080">)</FONT>
    <FONT COLOR="#000080">{</FONT>
      <FONT COLOR="#008000">FreeTree</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">W</FONT><FONT COLOR="#000080">-&gt;</FONT><FONT COLOR="#008000">Right</FONT><FONT COLOR="#000080">);</FONT>
      <FONT COLOR="#008000">W</FONT><FONT COLOR="#000080">-&gt;</FONT><FONT COLOR="#008000">Right</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#000080">}</FONT>
  <FONT COLOR="#000080">}</FONT>
<FONT COLOR="#000080">}</FONT>


<B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">AddToTree</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">WORD</FONT> <FONT COLOR="#000080">**</FONT><FONT COLOR="#008000">DestTree</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">size_t</FONT> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">Treecount</FONT><FONT COLOR="#000080">,</FONT> <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">Word</FONT><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
  <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">Status</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">SUCCESS</FONT><FONT COLOR="#000080">;</FONT>
  <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">CompResult</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>

  <FONT COLOR="#008080">/* safety check */</FONT>
  <FONT COLOR="#008000">assert</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">NULL</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">DestTree</FONT><FONT COLOR="#000080">);</FONT>
  <FONT COLOR="#008000">assert</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">NULL</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">Treecount</FONT><FONT COLOR="#000080">);</FONT>
  <FONT COLOR="#008000">assert</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">NULL</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">Word</FONT><FONT COLOR="#000080">);</FONT>

  <FONT COLOR="#008080">/* ok, either *DestTree is NULL or it isn't (deep huh?) */</FONT>
  <B><FONT COLOR="#000080">if</FONT></B><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">NULL</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">DestTree</FONT><FONT COLOR="#000080">)</FONT>  <FONT COLOR="#008080">/* this is the place to add it then */</FONT>
  <FONT COLOR="#000080">{</FONT>
    <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">DestTree</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">malloc</FONT><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">sizeof</FONT></B> <FONT COLOR="#000080">**</FONT><FONT COLOR="#008000">DestTree</FONT><FONT COLOR="#000080">);</FONT>
    <B><FONT COLOR="#000080">if</FONT></B><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">NULL</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">DestTree</FONT><FONT COLOR="#000080">)</FONT> 
    <FONT COLOR="#000080">{</FONT>
      <FONT COLOR="#008080">/* horrible - we're out of memory */</FONT>
      <FONT COLOR="#008000">Status</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">NO_MEMORY_FOR_WORDNODE</FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#000080">}</FONT>
    <B><FONT COLOR="#000080">else</FONT></B>
    <FONT COLOR="#000080">{</FONT>
      <FONT COLOR="#000080">(*</FONT><FONT COLOR="#008000">DestTree</FONT><FONT COLOR="#000080">)-&gt;</FONT><FONT COLOR="#008000">Left</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">;</FONT>
      <FONT COLOR="#000080">(*</FONT><FONT COLOR="#008000">DestTree</FONT><FONT COLOR="#000080">)-&gt;</FONT><FONT COLOR="#008000">Right</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">;</FONT>
      <FONT COLOR="#000080">(*</FONT><FONT COLOR="#008000">DestTree</FONT><FONT COLOR="#000080">)-&gt;</FONT><FONT COLOR="#008000">Count</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
      <FONT COLOR="#000080">(*</FONT><FONT COLOR="#008000">DestTree</FONT><FONT COLOR="#000080">)-&gt;</FONT><FONT COLOR="#008000">Word</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">dupstr</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">Word</FONT><FONT COLOR="#000080">);</FONT>
      <B><FONT COLOR="#000080">if</FONT></B><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">NULL</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#000080">(*</FONT><FONT COLOR="#008000">DestTree</FONT><FONT COLOR="#000080">)-&gt;</FONT><FONT COLOR="#008000">Word</FONT><FONT COLOR="#000080">)</FONT>
      <FONT COLOR="#000080">{</FONT>
        <FONT COLOR="#008080">/* even more horrible - we've run out of memory in the middle */</FONT>
        <FONT COLOR="#008000">Status</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">NO_MEMORY_FOR_WORD</FONT><FONT COLOR="#000080">;</FONT> 
        <FONT COLOR="#008000">free</FONT><FONT COLOR="#000080">(*</FONT><FONT COLOR="#008000">DestTree</FONT><FONT COLOR="#000080">);</FONT>
        <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">DestTree</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">;</FONT>
      <FONT COLOR="#000080">}</FONT>
      <B><FONT COLOR="#000080">else</FONT></B>
      <FONT COLOR="#000080">{</FONT>
        <FONT COLOR="#008080">/* everything was successful, add one to the tree nodes count */</FONT>
        <FONT COLOR="#000080">++*</FONT><FONT COLOR="#008000">Treecount</FONT><FONT COLOR="#000080">;</FONT>
      <FONT COLOR="#000080">}</FONT>
    <FONT COLOR="#000080">}</FONT>
  <FONT COLOR="#000080">}</FONT>
  <B><FONT COLOR="#000080">else</FONT></B>  <FONT COLOR="#008080">/* we need to make a decision */</FONT>
  <FONT COLOR="#000080">{</FONT>
    <FONT COLOR="#008000">CompResult</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">strcmp</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">Word</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000080">(*</FONT><FONT COLOR="#008000">DestTree</FONT><FONT COLOR="#000080">)-&gt;</FONT><FONT COLOR="#008000">Word</FONT><FONT COLOR="#000080">);</FONT>
    <B><FONT COLOR="#000080">if</FONT></B><FONT COLOR="#000080">(</FONT><FONT COLOR="#000000"><B>0</B></FONT> <FONT COLOR="#000080">&lt;</FONT> <FONT COLOR="#008000">CompResult</FONT><FONT COLOR="#000080">)</FONT>
    <FONT COLOR="#000080">{</FONT>
      <FONT COLOR="#008000">Status</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">AddToTree</FONT><FONT COLOR="#000080">(&amp;(*</FONT><FONT COLOR="#008000">DestTree</FONT><FONT COLOR="#000080">)-&gt;</FONT><FONT COLOR="#008000">Left</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">Treecount</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">Word</FONT><FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#000080">}</FONT>
    <B><FONT COLOR="#000080">else</FONT></B> <B><FONT COLOR="#000080">if</FONT></B><FONT COLOR="#000080">(</FONT><FONT COLOR="#000000"><B>0</B></FONT> <FONT COLOR="#000080">&gt;</FONT> <FONT COLOR="#008000">CompResult</FONT><FONT COLOR="#000080">)</FONT>
    <FONT COLOR="#000080">{</FONT>
      <FONT COLOR="#008000">Status</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">AddToTree</FONT><FONT COLOR="#000080">(&amp;(*</FONT><FONT COLOR="#008000">DestTree</FONT><FONT COLOR="#000080">)-&gt;</FONT><FONT COLOR="#008000">Left</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">Treecount</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">Word</FONT><FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#000080">}</FONT>
    <B><FONT COLOR="#000080">else</FONT></B>
    <FONT COLOR="#000080">{</FONT>
      <FONT COLOR="#008080">/* add one to the count - this is the same node */</FONT>
      <FONT COLOR="#000080">++(*</FONT><FONT COLOR="#008000">DestTree</FONT><FONT COLOR="#000080">)-&gt;</FONT><FONT COLOR="#008000">Count</FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#000080">}</FONT>
  <FONT COLOR="#000080">}</FONT>  <FONT COLOR="#008080">/* end of else we need to make a decision */</FONT>

  <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#008000">Status</FONT><FONT COLOR="#000080">;</FONT>  
<FONT COLOR="#000080">}</FONT>


<B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">ReadInputToTree</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">WORD</FONT> <FONT COLOR="#000080">**</FONT><FONT COLOR="#008000">DestTree</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">size_t</FONT> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">Treecount</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">FILE</FONT> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">Input</FONT><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
  <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">Status</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">SUCCESS</FONT><FONT COLOR="#000080">;</FONT>
  <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#008000">Buf</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#000000"><B>8192</B></FONT><FONT COLOR="#000080">]</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000080">{</FONT><FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">};</FONT>
  <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">Word</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">;</FONT>

  <FONT COLOR="#008080">/* safety check */</FONT>
  <FONT COLOR="#008000">assert</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">NULL</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">DestTree</FONT><FONT COLOR="#000080">);</FONT>
  <FONT COLOR="#008000">assert</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">NULL</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">Treecount</FONT><FONT COLOR="#000080">);</FONT>
  <FONT COLOR="#008000">assert</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">NULL</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">Input</FONT><FONT COLOR="#000080">);</FONT>

  <FONT COLOR="#008080">/* for every line */</FONT>
  <B><FONT COLOR="#000080">while</FONT></B><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">NULL</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">fgets</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">Buf</FONT><FONT COLOR="#000080">,</FONT> <B><FONT COLOR="#000080">sizeof</FONT></B> <FONT COLOR="#008000">Buf</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">Input</FONT><FONT COLOR="#000080">))</FONT>
  <FONT COLOR="#000080">{</FONT>
    <FONT COLOR="#008080">/* strtok the input to get only alpha character words */</FONT>
    <FONT COLOR="#008000">Word</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">strtok</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">Buf</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">NONALPHA</FONT><FONT COLOR="#000080">);</FONT>
    <B><FONT COLOR="#000080">while</FONT></B><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">SUCCESS</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">Status</FONT> <FONT COLOR="#000080">&amp;&amp;</FONT> <FONT COLOR="#008000">NULL</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">Word</FONT><FONT COLOR="#000080">)</FONT>
    <FONT COLOR="#000080">{</FONT>
      <FONT COLOR="#008080">/* deal with this word by adding it to the tree */</FONT>
      <FONT COLOR="#008000">Status</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">AddToTree</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">DestTree</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">Treecount</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">Word</FONT><FONT COLOR="#000080">);</FONT> 

      <FONT COLOR="#008080">/* next word */</FONT>
      <B><FONT COLOR="#000080">if</FONT></B><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">SUCCESS</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">Status</FONT><FONT COLOR="#000080">)</FONT> 
      <FONT COLOR="#000080">{</FONT>
        <FONT COLOR="#008000">Word</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">strtok</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">NONALPHA</FONT><FONT COLOR="#000080">);</FONT>
      <FONT COLOR="#000080">}</FONT>
    <FONT COLOR="#000080">}</FONT>
  <FONT COLOR="#000080">}</FONT>

  <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#008000">Status</FONT><FONT COLOR="#000080">;</FONT>
<FONT COLOR="#000080">}</FONT>




<B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">WalkTree</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">WORD</FONT> <FONT COLOR="#000080">**</FONT><FONT COLOR="#008000">DestArray</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">WORD</FONT> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">Word</FONT><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
  <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">Status</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">SUCCESS</FONT><FONT COLOR="#000080">;</FONT>
  <B><FONT COLOR="#000080">static</FONT></B> <FONT COLOR="#008000">WORD</FONT> <FONT COLOR="#000080">**</FONT><FONT COLOR="#008000">Write</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">;</FONT>
  
  <FONT COLOR="#008080">/* safety check */</FONT>
  <FONT COLOR="#008000">assert</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">NULL</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">Word</FONT><FONT COLOR="#000080">);</FONT>

  <FONT COLOR="#008080">/* store the starting point if this is the first call */</FONT>
  <B><FONT COLOR="#000080">if</FONT></B><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">NULL</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">DestArray</FONT><FONT COLOR="#000080">)</FONT>
  <FONT COLOR="#000080">{</FONT>
    <FONT COLOR="#008000">Write</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">DestArray</FONT><FONT COLOR="#000080">;</FONT>
  <FONT COLOR="#000080">}</FONT>

  <FONT COLOR="#008080">/* Now add this node and it's kids */</FONT>
  <B><FONT COLOR="#000080">if</FONT></B><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">NULL</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">Word</FONT><FONT COLOR="#000080">)</FONT>
  <FONT COLOR="#000080">{</FONT>
    <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">Write</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">Word</FONT><FONT COLOR="#000080">;</FONT>
    <FONT COLOR="#000080">++</FONT><FONT COLOR="#008000">Write</FONT><FONT COLOR="#000080">;</FONT>
    <B><FONT COLOR="#000080">if</FONT></B><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">NULL</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">Word</FONT><FONT COLOR="#000080">-&gt;</FONT><FONT COLOR="#008000">Left</FONT><FONT COLOR="#000080">)</FONT>
    <FONT COLOR="#000080">{</FONT>
      <FONT COLOR="#008000">Status</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">WalkTree</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">Word</FONT><FONT COLOR="#000080">-&gt;</FONT><FONT COLOR="#008000">Left</FONT><FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#000080">}</FONT>
    <B><FONT COLOR="#000080">if</FONT></B><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">NULL</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">Word</FONT><FONT COLOR="#000080">-&gt;</FONT><FONT COLOR="#008000">Right</FONT><FONT COLOR="#000080">)</FONT>
    <FONT COLOR="#000080">{</FONT>
      <FONT COLOR="#008000">Status</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">WalkTree</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">Word</FONT><FONT COLOR="#000080">-&gt;</FONT><FONT COLOR="#008000">Right</FONT><FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#000080">}</FONT>
  <FONT COLOR="#000080">}</FONT>

  <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#008000">Status</FONT><FONT COLOR="#000080">;</FONT>
<FONT COLOR="#000080">}</FONT>


<FONT COLOR="#008080">/*
   CompareCounts is called by qsort. This means that it gets pointers to the 
   data items being compared. In this case the data items are pointers too. 
*/</FONT>
<B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">CompareCounts</FONT><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">const</FONT></B> <B><FONT COLOR="#000080">void</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">vWord1</FONT><FONT COLOR="#000080">,</FONT> <B><FONT COLOR="#000080">const</FONT></B> <B><FONT COLOR="#000080">void</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">vWord2</FONT><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
  <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">Result</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
  <FONT COLOR="#008000">WORD</FONT> <FONT COLOR="#000080">*</FONT> <B><FONT COLOR="#000080">const</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">Word1</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">vWord1</FONT><FONT COLOR="#000080">;</FONT>
  <FONT COLOR="#008000">WORD</FONT> <FONT COLOR="#000080">*</FONT> <B><FONT COLOR="#000080">const</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">Word2</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">vWord2</FONT><FONT COLOR="#000080">;</FONT>
 
  <FONT COLOR="#008000">assert</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">NULL</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">vWord1</FONT><FONT COLOR="#000080">);</FONT> 
  <FONT COLOR="#008000">assert</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">NULL</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">vWord2</FONT><FONT COLOR="#000080">);</FONT> 

  <FONT COLOR="#008080">/* ensure the result is either 1, 0 or -1 */</FONT>
  <B><FONT COLOR="#000080">if</FONT></B><FONT COLOR="#000080">((*</FONT><FONT COLOR="#008000">Word1</FONT><FONT COLOR="#000080">)-&gt;</FONT><FONT COLOR="#008000">Count</FONT> <FONT COLOR="#000080">&lt;</FONT> <FONT COLOR="#000080">(*</FONT><FONT COLOR="#008000">Word2</FONT><FONT COLOR="#000080">)-&gt;</FONT><FONT COLOR="#008000">Count</FONT><FONT COLOR="#000080">)</FONT>
  <FONT COLOR="#000080">{</FONT>
    <FONT COLOR="#008000">Result</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
  <FONT COLOR="#000080">}</FONT>
  <B><FONT COLOR="#000080">else</FONT></B> <B><FONT COLOR="#000080">if</FONT></B><FONT COLOR="#000080">((*</FONT><FONT COLOR="#008000">Word1</FONT><FONT COLOR="#000080">)-&gt;</FONT><FONT COLOR="#008000">Count</FONT> <FONT COLOR="#000080">&gt;</FONT> <FONT COLOR="#000080">(*</FONT><FONT COLOR="#008000">Word2</FONT><FONT COLOR="#000080">)-&gt;</FONT><FONT COLOR="#008000">Count</FONT><FONT COLOR="#000080">)</FONT>
  <FONT COLOR="#000080">{</FONT>
    <FONT COLOR="#008000">Result</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000080">-</FONT><FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">;</FONT>
  <FONT COLOR="#000080">}</FONT>
  <B><FONT COLOR="#000080">else</FONT></B>
  <FONT COLOR="#000080">{</FONT>
    <FONT COLOR="#008000">Result</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
  <FONT COLOR="#000080">}</FONT>

  <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#008000">Result</FONT><FONT COLOR="#000080">;</FONT>
<FONT COLOR="#000080">}</FONT>


<B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">OutputWords</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">FILE</FONT> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">Dest</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">size_t</FONT> <FONT COLOR="#008000">Count</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">WORD</FONT> <FONT COLOR="#000080">**</FONT><FONT COLOR="#008000">WordArray</FONT><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
  <B><FONT COLOR="#000080">int</FONT></B> <FONT COLOR="#008000">Status</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">SUCCESS</FONT><FONT COLOR="#000080">;</FONT>
  <FONT COLOR="#008000">size_t</FONT> <FONT COLOR="#008000">Pos</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
 
  <FONT COLOR="#008080">/* safety check */</FONT>
  <FONT COLOR="#008000">assert</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">NULL</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">Dest</FONT><FONT COLOR="#000080">);</FONT>
  <FONT COLOR="#008000">assert</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">NULL</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">WordArray</FONT><FONT COLOR="#000080">);</FONT>

  <FONT COLOR="#008080">/* Print a header */</FONT>
  <FONT COLOR="#008000">fprintf</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">Dest</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000">&quot;Total Words : %lu\n&quot;</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">unsigned</FONT></B> <B><FONT COLOR="#000080">long</FONT></B><FONT COLOR="#000080">)</FONT><FONT COLOR="#008000">Count</FONT><FONT COLOR="#000080">);</FONT> 

  <FONT COLOR="#008080">/* Print the words in descending order */</FONT>
  <B><FONT COLOR="#000080">while</FONT></B><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">SUCCESS</FONT> <FONT COLOR="#000080">==</FONT> <FONT COLOR="#008000">Status</FONT> <FONT COLOR="#000080">&amp;&amp;</FONT> <FONT COLOR="#008000">Pos</FONT> <FONT COLOR="#000080">&lt;</FONT> <FONT COLOR="#008000">Count</FONT><FONT COLOR="#000080">)</FONT> 
  <FONT COLOR="#000080">{</FONT>
    <FONT COLOR="#008000">fprintf</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">Dest</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000000">&quot;%10lu %s\n&quot;</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">unsigned</FONT></B> <B><FONT COLOR="#000080">long</FONT></B><FONT COLOR="#000080">)</FONT><FONT COLOR="#008000">WordArray</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">Pos</FONT><FONT COLOR="#000080">]-&gt;</FONT><FONT COLOR="#008000">Count</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">WordArray</FONT><FONT COLOR="#000080">[</FONT><FONT COLOR="#008000">Pos</FONT><FONT COLOR="#000080">]-&gt;</FONT><FONT COLOR="#008000">Word</FONT><FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#000080">++</FONT><FONT COLOR="#008000">Pos</FONT><FONT COLOR="#000080">;</FONT>
  <FONT COLOR="#000080">}</FONT>

  <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#008000">Status</FONT><FONT COLOR="#000080">;</FONT>
<FONT COLOR="#000080">}</FONT>


<FONT COLOR="#008080">/*
    dupstr: duplicate a string
*/</FONT>
<B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">dupstr</FONT><FONT COLOR="#000080">(</FONT><B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">s</FONT><FONT COLOR="#000080">)</FONT>
<FONT COLOR="#000080">{</FONT>
  <B><FONT COLOR="#000080">char</FONT></B> <FONT COLOR="#000080">*</FONT><FONT COLOR="#008000">Result</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">NULL</FONT><FONT COLOR="#000080">;</FONT>
  <FONT COLOR="#008000">size_t</FONT> <FONT COLOR="#008000">slen</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>0</B></FONT><FONT COLOR="#000080">;</FONT>
  
  <FONT COLOR="#008080">/* sanity check */</FONT>
  <FONT COLOR="#008000">assert</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">NULL</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">s</FONT><FONT COLOR="#000080">);</FONT>

  <FONT COLOR="#008080">/* get string length */</FONT>
  <FONT COLOR="#008000">slen</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">strlen</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">s</FONT><FONT COLOR="#000080">);</FONT>
  
  <FONT COLOR="#008080">/* allocate enough storage */</FONT>
  <FONT COLOR="#008000">Result</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#008000">malloc</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">slen</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#000000"><B>1</B></FONT><FONT COLOR="#000080">);</FONT>
 
  <FONT COLOR="#008080">/* populate string */</FONT>
  <B><FONT COLOR="#000080">if</FONT></B><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">NULL</FONT> <FONT COLOR="#000080">!=</FONT> <FONT COLOR="#008000">Result</FONT><FONT COLOR="#000080">)</FONT>
  <FONT COLOR="#000080">{</FONT>
    <FONT COLOR="#008000">memcpy</FONT><FONT COLOR="#000080">(</FONT><FONT COLOR="#008000">Result</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">s</FONT><FONT COLOR="#000080">,</FONT> <FONT COLOR="#008000">slen</FONT><FONT COLOR="#000080">);</FONT>
    <FONT COLOR="#000080">*(</FONT><FONT COLOR="#008000">Result</FONT> <FONT COLOR="#000080">+</FONT> <FONT COLOR="#008000">slen</FONT><FONT COLOR="#000080">)</FONT> <FONT COLOR="#000080">=</FONT> <FONT COLOR="#000000"><B>'\0'</B></FONT><FONT COLOR="#000080">;</FONT>
  <FONT COLOR="#000080">}</FONT>

  <B><FONT COLOR="#000080">return</FONT></B> <FONT COLOR="#008000">Result</FONT><FONT COLOR="#000080">;</FONT>
<FONT COLOR="#000080">}</FONT>




</pre>
</code>

<br>
<br>
<br>
<br>

<a href=index.html>  Back to index </a></body></html>